import{_ as s,o as a,c as p,b as t}from"./app.fe102d59.js";const e="/vuepress-java/assets/image-20201208143929602.eec410e1.png",o="/vuepress-java/assets/image-20201211113721758.7ae5b77b.png",n="/vuepress-java/assets/1567496518185.f4a3eb01.png",c="/vuepress-java/assets/1567497614205.1934f70e.png",l="/vuepress-java/assets/image-20201208180725556.47a51bb3.png",i="/vuepress-java/assets/image-20201208212007691.4a2b21e1.png",u="/vuepress-java/assets/image-20201214105907912.5957db0a.png",k="/vuepress-java/assets/image-20201209162304889.d554d580.png",r="/vuepress-java/assets/image-20201209195645804.e4b84962.png",d="/vuepress-java/assets/\u4E3B\u9875\u9762-\u4E00\u671F-\u6DFB\u52A0\u56FE\u7247\u540E.3c467064.png",m="/vuepress-java/assets/image-20201210173432543.45019a5b.png",v="/vuepress-java/assets/image-20201210213548508.e715db27.png",b="/vuepress-java/assets/image-20201211005052474.ec2df309.png",g={},y=t(`<h2 id="\u8BFE\u7A0B\u8BF4\u660E" tabindex="-1"><a class="header-anchor" href="#\u8BFE\u7A0B\u8BF4\u660E" aria-hidden="true">#</a> \u8BFE\u7A0B\u8BF4\u660E</h2><ul><li>\u62BD\u53D6common\u5DE5\u7A0B</li><li>\u5708\u5B50\u529F\u80FD\u8BF4\u660E</li><li>\u5708\u5B50\u6280\u672F\u5B9E\u73B0</li><li>\u5708\u5B50\u6280\u672F\u65B9\u6848</li><li>\u5708\u5B50\u5B9E\u73B0\u53D1\u5E03\u52A8\u6001</li><li>\u5708\u5B50\u5B9E\u73B0\u597D\u53CB\u52A8\u6001</li><li>\u5708\u5B50\u5B9E\u73B0\u63A8\u8350\u52A8\u6001</li></ul><h2 id="_1\u3001\u62BD\u53D6common\u5DE5\u7A0B" tabindex="-1"><a class="header-anchor" href="#_1\u3001\u62BD\u53D6common\u5DE5\u7A0B" aria-hidden="true">#</a> 1\u3001\u62BD\u53D6common\u5DE5\u7A0B</h2><p>\u5728\u9879\u76EE\u4E2D\u4E00\u822C\u9700\u8981\u5C06\u516C\u7528\u7684\u5BF9\u8C61\u8FDB\u884C\u62BD\u53D6\u653E\u5230common\u5DE5\u7A0B\u4E2D\uFF0C\u5176\u4ED6\u7684\u5DE5\u7A0B\u4F9D\u8D56\u6B64\u5DE5\u7A0B\u5373\u53EF\u3002\u4E0B\u9762\u6211\u4EEC\u5C06sso\u4EE5\u53CAserver\u5DE5\u7A0B\u4E2D\u7684\u516C\u7528\u7684\u5BF9\u8C61\u8FDB\u884C\u62BD\u53D6\u3002</p><h3 id="_1-1\u3001\u521B\u5EFAmy-tanhua-common\u5DE5\u7A0B" tabindex="-1"><a class="header-anchor" href="#_1-1\u3001\u521B\u5EFAmy-tanhua-common\u5DE5\u7A0B" aria-hidden="true">#</a> 1.1\u3001\u521B\u5EFAmy-tanhua-common\u5DE5\u7A0B</h3><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>my-tanhua<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.itcast.tanhua<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>my-tanhua-common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-plus-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.fasterxml.jackson.core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jackson-databind<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-2\u3001\u901A\u7528\u679A\u4E3E" tabindex="-1"><a class="header-anchor" href="#_1-2\u3001\u901A\u7528\u679A\u4E3E" aria-hidden="true">#</a> 1.2\u3001\u901A\u7528\u679A\u4E3E</h3><p>\u5C06SexEnum\u679A\u4E3E\u79FB\u52A8\u81F3common\u5DE5\u7A0B\uFF0C\u5E76\u4E14\u540E\u7EED\u521B\u5EFA\u7684\u679A\u4E3E\u4E5F\u8981\u653E\u5230\u6B21\u5DE5\u7A0B\u4E2D\uFF0C\u4EE5\u8FBE\u5230\u516C\u7528\u7684\u76EE\u7684\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>common<span class="token punctuation">.</span>enums</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums<span class="token punctuation">.</span></span><span class="token class-name">IEnum</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">SexEnum</span> <span class="token keyword">implements</span> <span class="token class-name">IEnum</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token function">MAN</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">&quot;\u7537&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">WOMAN</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">&quot;\u5973&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">UNKNOWN</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">&quot;\u672A\u77E5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">int</span> value<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> desc<span class="token punctuation">;</span>

    <span class="token class-name">SexEnum</span><span class="token punctuation">(</span><span class="token keyword">int</span> value<span class="token punctuation">,</span> <span class="token class-name">String</span> desc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>desc <span class="token operator">=</span> desc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>desc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u9700\u8981\u4FEE\u6539server\u4E0Esso\u5DE5\u7A0B\u4E2D\u7684application.properties\u914D\u7F6E\uFF1A</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token comment"># \u679A\u4E3E\u5305\u626B\u63CF</span>
<span class="token key attr-name">mybatis-plus.type-enums-package</span><span class="token punctuation">=</span><span class="token value attr-value">com.tanhua.common.enums</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5C06server\u4E0Esso\u5DE5\u7A0B\u4E2D\u7684SexEnum\u5BF9\u8C61\u5220\u9664\u4EE5\u53CA\u5C06\u76F8\u5173\u7684\u7C7B\u5F15\u7528\u8FDB\u884C\u4FEE\u6539\u3002</p><h3 id="_1-3\u3001\u62BD\u53D6mapper" tabindex="-1"><a class="header-anchor" href="#_1-3\u3001\u62BD\u53D6mapper" aria-hidden="true">#</a> 1.3\u3001\u62BD\u53D6mapper</h3><p>\u9700\u8981\u5C06UserInfoMapper\u4EE5\u53CAUserMapper\u653E\u7F6E\u5230common\u5DE5\u7A0B\u7684com.tanhua.common.mapper\u5305\u4E0B\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>common<span class="token punctuation">.</span>mapper</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">BaseMapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>common<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserMapper</span> <span class="token keyword">extends</span> <span class="token class-name">BaseMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>common<span class="token punctuation">.</span>mapper</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>baomidou<span class="token punctuation">.</span>mybatisplus<span class="token punctuation">.</span>core<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">BaseMapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>common<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">UserInfo</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserInfoMapper</span> <span class="token keyword">extends</span> <span class="token class-name">BaseMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>\u8BF4\u660E\uFF1A\u62BD\u53D6\u5B8C\u6210\u540E\uFF0C\u9700\u8981\u5C06\u539F\u5DE5\u7A0B\u7684\u4EE3\u7801\u5220\u9664\u4EE5\u53CA\u4FEE\u6539\u5176\u4ED6\u4EE3\u7801\u4E2D\u5F15\u5165\u7684\u4F9D\u8D56\u3002</strong></p></blockquote><h3 id="_1-4\u3001\u62BD\u53D6pojo" tabindex="-1"><a class="header-anchor" href="#_1-4\u3001\u62BD\u53D6pojo" aria-hidden="true">#</a> 1.4\u3001\u62BD\u53D6pojo</h3><p>\u5C06BasePojo\u3001User\u3001UserInfo\u79FB\u52A8\u81F3common\u5DE5\u7A0B\uFF1A</p><p><img src="`+e+'" alt="image-20201208143929602"></p><h3 id="_1-5\u3001\u62BD\u53D6utils" tabindex="-1"><a class="header-anchor" href="#_1-5\u3001\u62BD\u53D6utils" aria-hidden="true">#</a> 1.5\u3001\u62BD\u53D6utils</h3><p>\u5C06server\u5DE5\u7A0B\u7684utils\u8FDB\u884C\u62BD\u53D6\u516C\u7528\uFF0C\u540E\u7EED\u7684\u5DE5\u5177\u7C7B\u4E5F\u653E\u7F6E\u5230common\u5DE5\u7A0B\u4E2D\u3002</p><p><img src="'+o+'" alt="image-20201211113721758"></p><blockquote><p><strong>\u62BD\u53D6\u5B8C\u6210\u540E\u8FDB\u884C\u6D4B\u8BD5\uFF0C\u786E\u4FDD\u53EF\u4EE5\u6B63\u5E38\u542F\u52A8\u4EE5\u53CA\u529F\u80FD\u90FD\u6B63\u5E38\u3002</strong></p></blockquote><h2 id="_2\u3001\u5708\u5B50\u529F\u80FD" tabindex="-1"><a class="header-anchor" href="#_2\u3001\u5708\u5B50\u529F\u80FD" aria-hidden="true">#</a> 2\u3001\u5708\u5B50\u529F\u80FD</h2><h3 id="_2-1\u3001\u529F\u80FD\u8BF4\u660E" tabindex="-1"><a class="header-anchor" href="#_2-1\u3001\u529F\u80FD\u8BF4\u660E" aria-hidden="true">#</a> 2.1\u3001\u529F\u80FD\u8BF4\u660E</h3><p>\u63A2\u82B1\u4EA4\u53CB\u9879\u76EE\u4E2D\u7684\u5708\u5B50\u529F\u80FD\uFF0C\u7C7B\u4F3C\u5FAE\u4FE1\u7684\u670B\u53CB\u5708\uFF0C\u57FA\u672C\u7684\u529F\u80FD\u4E3A\uFF1A\u53D1\u5E03\u52A8\u6001\u3001\u6D4F\u89C8\u597D\u53CB\u52A8\u6001\u3001\u6D4F\u89C8\u63A8\u8350\u52A8\u6001\u3001\u70B9\u8D5E\u3001\u8BC4\u8BBA\u3001\u559C\u6B22\u7B49\u529F\u80FD\u3002</p><p><img src="'+n+'" alt="1567496518185"></p><p>\u53D1\u5E03\uFF1A</p><p><img src="'+c+'" alt="1567497614205"></p><h3 id="_2-2\u3001\u5B9E\u73B0\u65B9\u6848\u5206\u6790" tabindex="-1"><a class="header-anchor" href="#_2-2\u3001\u5B9E\u73B0\u65B9\u6848\u5206\u6790" aria-hidden="true">#</a> 2.2\u3001\u5B9E\u73B0\u65B9\u6848\u5206\u6790</h3><p>\u5BF9\u4E8E\u5708\u5B50\u529F\u80FD\u7684\u5B9E\u73B0\uFF0C\u6211\u4EEC\u9700\u8981\u5BF9\u5B83\u7684\u529F\u80FD\u7279\u70B9\u505A\u5206\u6790\uFF1A</p><ul><li>\u6570\u636E\u91CF\u4F1A\u968F\u7740\u7528\u6237\u6570\u589E\u5927\u800C\u589E\u5927</li><li>\u8BFB\u591A\u5199\u5C11\uFF0C\u4E00\u822C\u800C\u8A00\uFF0C\u6D4F\u89C8\u670B\u53CB\u5708\u52A8\u6001\u4F1A\u591A\u4E00\u4E9B\uFF0C\u53D1\u52A8\u6001\u76F8\u5BF9\u5C31\u4F1A\u5C11\u4E00\u4E9B</li><li>\u975E\u597D\u53CB\u770B\u4E0D\u5230\u5176\u52A8\u6001\u5185\u5BB9</li><li>\u2026\u2026</li></ul><p>\u9488\u5BF9\u4EE5\u4E0A\u7279\u70B9\uFF0C\u6211\u4EEC\u6765\u5206\u6790\u4E00\u4E0B\uFF1A</p><ul><li>\u5BF9\u4E8E\u6570\u636E\u91CF\u5927\u800C\u8A00\uFF0C\u663E\u7136\u4E0D\u80FD\u591F\u4F7F\u7528\u5173\u7CFB\u578B\u6570\u636E\u5E93\u8FDB\u884C\u5B58\u50A8\uFF0C\u6211\u4EEC\u9700\u8981\u901A\u8FC7MongoDB\u8FDB\u884C\u5B58\u50A8</li><li>\u5BF9\u4E8E\u8BFB\u591A\u5199\u5C11\u7684\u5E94\u7528\uFF0C\u5C3D\u53EF\u80FD\u7684\u51CF\u5C11\u8BFB\u53D6\u6570\u636E\u7684\u6210\u672C <ul><li>\u6BD4\u5982\u8BF4\uFF0C\u4E00\u6761SQL\u8BED\u53E5\uFF0C\u5355\u5F20\u8868\u67E5\u8BE2\u4E00\u5B9A\u6BD4\u591A\u5F20\u8868\u67E5\u8BE2\u8981\u5FEB</li><li>\u6761\u4EF6\u8D8A\u591A\u7684\u67E5\u8BE2\u901F\u5EA6\u5C06\u8D8A\u6162\uFF0C\u5C3D\u53EF\u80FD\u7684\u51CF\u5C11\u6761\u4EF6\u4EE5\u63D0\u5347\u67E5\u8BE2\u901F\u5EA6</li></ul></li></ul><p><strong>\u6240\u4EE5\u5BF9\u4E8E\u5B58\u50A8\u800C\u8A00\uFF0C\u4E3B\u8981\u662F\u6838\u5FC3\u76844\u5F20\u8868\uFF1A</strong></p><ul><li>\u53D1\u5E03\u8868\uFF1A\u8BB0\u5F55\u4E86\u6240\u6709\u7528\u6237\u7684\u53D1\u5E03\u7684\u4E1C\u897F\u4FE1\u606F\uFF0C\u5982\u56FE\u7247\u3001\u89C6\u9891\u7B49\u3002</li><li>\u76F8\u518C\uFF1A\u76F8\u518C\u662F\u6BCF\u4E2A\u7528\u6237\u72EC\u7ACB\u7684\uFF0C\u8BB0\u5F55\u4E86\u8BE5\u7528\u6237\u6240\u53D1\u5E03\u7684\u6240\u6709\u5185\u5BB9\u3002</li><li>\u8BC4\u8BBA\uFF1A\u9488\u5BF9\u67D0\u4E2A\u5177\u4F53\u53D1\u5E03\u7684\u670B\u53CB\u8BC4\u8BBA\u548C\u70B9\u8D5E\u64CD\u4F5C\u3002</li><li>\u65F6\u95F4\u7EBF\uFF1A\u6240\u8C13\u201C\u5237\u670B\u53CB\u5708\u201D\uFF0C\u5C31\u662F\u5237\u65F6\u95F4\u7EBF\uFF0C\u5C31\u662F\u4E00\u4E2A\u7528\u6237\u6240\u6709\u7684\u670B\u53CB\u7684\u53D1\u5E03\u5185\u5BB9\u3002</li></ul><p>\u6D41\u7A0B\uFF1A</p><p><img src="'+l+`" alt="image-20201208180725556"></p><p>\u6D41\u7A0B\u8BF4\u660E\uFF1A</p><ul><li>\u7528\u6237\u53D1\u5E03\u52A8\u6001\uFF0C\u52A8\u6001\u4E2D\u4E00\u822C\u5305\u542B\u4E86\u56FE\u7247\u548C\u6587\u5B57\uFF0C\u56FE\u7247\u4E0A\u4F20\u5230\u963F\u91CC\u4E91\uFF0C\u4E0A\u4F20\u6210\u529F\u540E\u62FF\u5230\u56FE\u7247\u5730\u5740\uFF0C\u5C06\u6587\u5B57\u548C\u56FE\u7247\u5730\u5740\u8FDB\u884C\u6301\u4E45\u5316\u5B58\u50A8</li><li>\u9996\u5148\uFF0C\u9700\u8981\u5C06\u52A8\u6001\u6570\u636E\u5199\u5165\u5230\u53D1\u5E03\u8868\u4E2D\uFF0C\u5176\u6B21\uFF0C\u518D\u5199\u5165\u5230\u81EA\u5DF1\u7684\u76F8\u518C\u8868\u4E2D\uFF0C\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0C\u76F8\u518C\u8868\u4E2D\u53EA\u5305\u542B\u4E86\u53D1\u5E03id\uFF0C\u4E0D\u4F1A\u5197\u4F59\u5B58\u50A8\u53D1\u5E03\u6570\u636E</li><li>\u6700\u540E\uFF0C\u9700\u8981\u5C06\u53D1\u5E03\u6570\u636E\u5F02\u6B65\u7684\u5199\u5165\u5230\u597D\u53CB\u7684\u65F6\u95F4\u7EBF\u8868\u4E2D\uFF0C\u4E4B\u6240\u4EE5\u8003\u8651\u5F02\u6B65\u64CD\u4F5C\uFF0C\u662F\u56E0\u4E3A\u5E0C\u671B\u53D1\u5E03\u80FD\u591F\u5C3D\u5FEB\u7ED9\u7528\u6237\u53CD\u9988\uFF0C\u53D1\u5E03\u6210\u529F</li><li>\u597D\u53CB\u5237\u670B\u53CB\u5708\u65F6\uFF0C\u5B9E\u9645\u4E0A\u53EA\u9700\u8981\u67E5\u8BE2\u81EA\u5DF1\u7684\u65F6\u95F4\u7EBF\u8868\u5373\u53EF\uFF0C\u8FD9\u6837\u6700\u5927\u9650\u5EA6\u7684\u63D0\u5347\u4E86\u67E5\u8BE2\u901F\u5EA6\uFF0C\u518D\u914D\u5408redis\u7684\u7F13\u5B58\uFF0C\u90A3\u901F\u5EA6\u5C06\u662F\u98DE\u5FEB\u7684</li><li>\u7528\u6237\u5728\u5BF9\u52A8\u6001\u5185\u5BB9\u8FDB\u884C\u70B9\u8D5E\u3001\u559C\u6B22\u3001\u8BC4\u8BBA\u64CD\u4F5C\u65F6\uFF0C\u53EA\u9700\u8981\u5199\u5165\u5230\u8BC4\u8BBA\u8868\u5373\u53EF\uFF0C\u8BE5\u8868\u4E2D\u4E5F\u662F\u53EA\u4F1A\u8BB0\u5F55\u53D1\u5E03id\uFF0C\u5E76\u4E0D\u4F1A\u5197\u4F59\u5B58\u50A8\u53D1\u5E03\u6570\u636E</li></ul><h3 id="_2-3\u3001\u8868\u7ED3\u6784\u8BBE\u8BA1" tabindex="-1"><a class="header-anchor" href="#_2-3\u3001\u8868\u7ED3\u6784\u8BBE\u8BA1" aria-hidden="true">#</a> 2.3\u3001\u8868\u7ED3\u6784\u8BBE\u8BA1</h3><blockquote><p><strong>\u53D1\u5E03\u8868\uFF1A</strong></p></blockquote><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#\u8868\u540D\uFF1Aquanzi_publish
<span class="token punctuation">{</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token string">&quot;5fae53d17e52992e78a3db61&quot;</span><span class="token punctuation">,</span>#\u4E3B\u952Eid
    <span class="token property">&quot;pid&quot;</span><span class="token operator">:</span><span class="token number">1001</span><span class="token punctuation">,</span> #\u53D1\u5E03id\uFF08Long\u7C7B\u578B\uFF09
    <span class="token property">&quot;userId&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> #\u7528\u6237id
    <span class="token property">&quot;text&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u4ECA\u5929\u5FC3\u60C5\u5F88\u597D&quot;</span><span class="token punctuation">,</span> #\u6587\u672C\u5185\u5BB9
    <span class="token property">&quot;medias&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://xxxx/x/y/z.jpg&quot;</span><span class="token punctuation">,</span> #\u5A92\u4F53\u6570\u636E\uFF0C\u56FE\u7247\u6216\u5C0F\u89C6\u9891 url
    <span class="token property">&quot;seeType&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> #\u8C01\u53EF\u4EE5\u770B\uFF0C<span class="token number">1</span>-\u516C\u5F00\uFF0C<span class="token number">2</span>-\u79C1\u5BC6\uFF0C<span class="token number">3</span>-\u90E8\u5206\u53EF\u89C1\uFF0C<span class="token number">4</span>-\u4E0D\u7ED9\u8C01\u770B
    <span class="token property">&quot;seeList&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> #\u90E8\u5206\u53EF\u89C1\u7684\u5217\u8868
    <span class="token property">&quot;notSeeList&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span>#\u4E0D\u7ED9\u8C01\u770B\u7684\u5217\u8868
	<span class="token property">&quot;longitude&quot;</span><span class="token operator">:</span><span class="token number">108.840974298098</span><span class="token punctuation">,</span>#\u7ECF\u5EA6
	<span class="token property">&quot;latitude&quot;</span><span class="token operator">:</span><span class="token number">34.2789316522934</span><span class="token punctuation">,</span>#\u7EAC\u5EA6
    <span class="token property">&quot;locationName&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u4E0A\u6D77\u5E02\u6D66\u4E1C\u533A&quot;</span><span class="token punctuation">,</span> #\u4F4D\u7F6E\u540D\u79F0
    <span class="token string">&quot;created&quot;</span><span class="token punctuation">,</span><span class="token number">1568012791171</span> #\u53D1\u5E03\u65F6\u95F4
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>\u76F8\u518C\u8868\uFF1A</strong></p></blockquote><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#\u8868\u540D\uFF1Aquanzi_album_<span class="token punctuation">{</span>userId<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token string">&quot;5fae539d7e52992e78a3b684&quot;</span><span class="token punctuation">,</span>#\u4E3B\u952Eid
    <span class="token property">&quot;publishId&quot;</span><span class="token operator">:</span><span class="token string">&quot;5fae53d17e52992e78a3db61&quot;</span><span class="token punctuation">,</span> #\u53D1\u5E03id
    <span class="token property">&quot;created&quot;</span><span class="token operator">:</span><span class="token number">1568012791171</span> #\u53D1\u5E03\u65F6\u95F4
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>\u65F6\u95F4\u7EBF\u8868\uFF1A</strong></p></blockquote><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#\u8868\u540D\uFF1Aquanzi_time_line_<span class="token punctuation">{</span>userId<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token string">&quot;5fae539b7e52992e78a3b4ae&quot;</span><span class="token punctuation">,</span>#\u4E3B\u952Eid<span class="token punctuation">,</span>
    <span class="token property">&quot;userId&quot;</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> #\u597D\u53CBid
    <span class="token property">&quot;publishId&quot;</span><span class="token operator">:</span><span class="token string">&quot;5fae53d17e52992e78a3db61&quot;</span><span class="token punctuation">,</span> #\u53D1\u5E03id
    <span class="token property">&quot;date&quot;</span><span class="token operator">:</span><span class="token number">1568012791171</span> #\u53D1\u5E03\u65F6\u95F4
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>\u8BC4\u8BBA\u8868\uFF1A</strong></p></blockquote><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>#\u8868\u540D\uFF1Aquanzi_comment
<span class="token punctuation">{</span>
    <span class="token property">&quot;_id&quot;</span><span class="token operator">:</span><span class="token string">&quot;5fae539d7e52992e78a3b648&quot;</span><span class="token punctuation">,</span> #\u4E3B\u952Eid
    <span class="token property">&quot;publishId&quot;</span><span class="token operator">:</span><span class="token string">&quot;5fae53d17e52992e78a3db61&quot;</span><span class="token punctuation">,</span> #\u53D1\u5E03id
    <span class="token property">&quot;commentType&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> #\u8BC4\u8BBA\u7C7B\u578B\uFF0C<span class="token number">1</span>-\u70B9\u8D5E\uFF0C<span class="token number">2</span>-\u8BC4\u8BBA\uFF0C<span class="token number">3</span>-\u559C\u6B22
    <span class="token property">&quot;content&quot;</span><span class="token operator">:</span><span class="token string">&quot;\u7ED9\u529B\uFF01&quot;</span><span class="token punctuation">,</span> #\u8BC4\u8BBA\u5185\u5BB9
    <span class="token property">&quot;userId&quot;</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> #\u8BC4\u8BBA\u4EBA
    <span class="token property">&quot;publishUserId&quot;</span><span class="token operator">:</span><span class="token number">9</span><span class="token punctuation">,</span> #\u53D1\u5E03\u52A8\u6001\u7684\u4EBA\u7684id
    <span class="token property">&quot;isParent&quot;</span><span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span> #\u662F\u5426\u4E3A\u7236\u8282\u70B9\uFF0C\u9ED8\u8BA4\u662F\u5426
    <span class="token property">&quot;parentId&quot;</span><span class="token operator">:</span><span class="token number">1001</span><span class="token punctuation">,</span> #\u7236\u8282\u70B9id
    <span class="token property">&quot;created&quot;</span><span class="token operator">:</span><span class="token number">1568012791171</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3\u3001\u597D\u53CB\u5173\u7CFB\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#_3\u3001\u597D\u53CB\u5173\u7CFB\u6570\u636E" aria-hidden="true">#</a> 3\u3001\u597D\u53CB\u5173\u7CFB\u6570\u636E</h2><p>\u7531\u4E8E\u5708\u5B50\u4E2D\u4F1A\u6D89\u53CA\u7684\u597D\u53CB\u5173\u7CFB\u6570\u636E\uFF0C\u867D\u7136\u73B0\u5728\u4E3B\u7EBF\u662F\u5F00\u53D1\u5708\u5B50\u529F\u80FD\uFF0C\u4F46\u662F\u4E5F\u9700\u8981\u5BF9\u4E8E\u597D\u53CB\u5173\u7CFB\u6709\u6240\u4E86\u89E3\uFF0C\u5728\u6211\u4EEC\u63D0\u4F9B\u7684Mongodb\u6570\u636E\u5E93\u4E2D\u6709\u4E00\u4E9Bmock\u6570\u636E\u3002</p><p>\u597D\u53CB\u5173\u7CFB\u7ED3\u6784\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>bson<span class="token punctuation">.</span>types<span class="token punctuation">.</span></span><span class="token class-name">ObjectId</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span>mapping<span class="token punctuation">.</span></span><span class="token class-name">Document</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span>collection <span class="token operator">=</span> <span class="token string">&quot;tanhua_users&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Users</span> <span class="token keyword">implements</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>Serializable</span><span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">6003135946820874230L</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">ObjectId</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span> <span class="token comment">//\u7528\u6237id</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> friendId<span class="token punctuation">;</span> <span class="token comment">//\u597D\u53CBid</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> date<span class="token punctuation">;</span> <span class="token comment">//\u65F6\u95F4</span>

<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728mock\u6570\u636E\u4E2D\uFF0C\u4E3A\u6BCF\u4E2A\u7528\u6237\u6784\u9020\u4E8610\u4E2A\u597D\u53CB\u6570\u636E\uFF1A</p><p><img src="`+i+'" alt="image-20201208212007691"></p><h2 id="_4\u3001\u67E5\u8BE2\u597D\u53CB\u52A8\u6001" tabindex="-1"><a class="header-anchor" href="#_4\u3001\u67E5\u8BE2\u597D\u53CB\u52A8\u6001" aria-hidden="true">#</a> 4\u3001\u67E5\u8BE2\u597D\u53CB\u52A8\u6001</h2><p>\u67E5\u8BE2\u597D\u53CB\u52A8\u6001\u4E0E\u67E5\u8BE2\u63A8\u8350\u52A8\u6001\u663E\u793A\u7684\u7ED3\u6784\u662F\u4E00\u6837\u7684\uFF0C\u53EA\u662F\u5176\u67E5\u8BE2\u6570\u636E\u6E90\u4E0D\u540C\uFF1A</p><p><img src="'+n+`" alt="1567496518185"></p><h3 id="_4-1\u3001\u57FA\u7840\u4EE3\u7801" tabindex="-1"><a class="header-anchor" href="#_4-1\u3001\u57FA\u7840\u4EE3\u7801" aria-hidden="true">#</a> 4.1\u3001\u57FA\u7840\u4EE3\u7801</h3><p>\u5728my-tanhua-dubbo-interface\u4E2D\u7F16\u5199\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>bson<span class="token punctuation">.</span>types<span class="token punctuation">.</span></span><span class="token class-name">ObjectId</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Id</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span>mapping<span class="token punctuation">.</span></span><span class="token class-name">Document</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * \u53D1\u5E03\u8868\uFF0C\u52A8\u6001\u5185\u5BB9
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span>collection <span class="token operator">=</span> <span class="token string">&quot;quanzi_publish&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Publish</span> <span class="token keyword">implements</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>Serializable</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">8732308321082804771L</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">ObjectId</span> id<span class="token punctuation">;</span> <span class="token comment">//\u4E3B\u952Eid</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> pid<span class="token punctuation">;</span> <span class="token comment">//\u53D1\u5E03id</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span> <span class="token comment">//\u53D1\u5E03\u7528\u6237id</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> text<span class="token punctuation">;</span> <span class="token comment">//\u6587\u5B57</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> medias<span class="token punctuation">;</span> <span class="token comment">//\u5A92\u4F53\u6570\u636E\uFF0C\u56FE\u7247\u6216\u5C0F\u89C6\u9891 url</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> seeType<span class="token punctuation">;</span> <span class="token comment">// \u8C01\u53EF\u4EE5\u770B\uFF0C1-\u516C\u5F00\uFF0C2-\u79C1\u5BC6\uFF0C3-\u90E8\u5206\u53EF\u89C1\uFF0C4-\u4E0D\u7ED9\u8C01\u770B</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> seeList<span class="token punctuation">;</span> <span class="token comment">//\u90E8\u5206\u53EF\u89C1\u7684\u5217\u8868</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> notSeeList<span class="token punctuation">;</span> <span class="token comment">//\u4E0D\u7ED9\u8C01\u770B\u7684\u5217\u8868</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> longitude<span class="token punctuation">;</span> <span class="token comment">//\u7ECF\u5EA6</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> latitude<span class="token punctuation">;</span> <span class="token comment">//\u7EAC\u5EA6</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> locationName<span class="token punctuation">;</span> <span class="token comment">//\u4F4D\u7F6E\u540D\u79F0</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> created<span class="token punctuation">;</span> <span class="token comment">//\u53D1\u5E03\u65F6\u95F4</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>bson<span class="token punctuation">.</span>types<span class="token punctuation">.</span></span><span class="token class-name">ObjectId</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Id</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span>mapping<span class="token punctuation">.</span></span><span class="token class-name">Document</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * \u76F8\u518C\u8868\uFF0C\u7528\u4E8E\u5B58\u50A8\u81EA\u5DF1\u53D1\u5E03\u7684\u6570\u636E\uFF0C\u6BCF\u4E00\u4E2A\u7528\u6237\u4E00\u5F20\u8868\u8FDB\u884C\u5B58\u50A8
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span>collection <span class="token operator">=</span> <span class="token string">&quot;quanzi_album_{userId}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Album</span> <span class="token keyword">implements</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>Serializable</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">432183095092216817L</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">ObjectId</span> id<span class="token punctuation">;</span> <span class="token comment">//\u4E3B\u952Eid</span>

    <span class="token keyword">private</span> <span class="token class-name">ObjectId</span> publishId<span class="token punctuation">;</span> <span class="token comment">//\u53D1\u5E03id</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> created<span class="token punctuation">;</span> <span class="token comment">//\u53D1\u5E03\u65F6\u95F4</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>bson<span class="token punctuation">.</span>types<span class="token punctuation">.</span></span><span class="token class-name">ObjectId</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Id</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span>mapping<span class="token punctuation">.</span></span><span class="token class-name">Document</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * \u65F6\u95F4\u7EBF\u8868\uFF0C\u7528\u4E8E\u5B58\u50A8\u53D1\u5E03\u7684\u6570\u636E\uFF0C\u6BCF\u4E00\u4E2A\u7528\u6237\u4E00\u5F20\u8868\u8FDB\u884C\u5B58\u50A8
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span>collection <span class="token operator">=</span> <span class="token string">&quot;quanzi_time_line_{userId}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TimeLine</span> <span class="token keyword">implements</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>Serializable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">9096178416317502524L</span><span class="token punctuation">;</span>
    
    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">ObjectId</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span> <span class="token comment">// \u597D\u53CBid</span>
    <span class="token keyword">private</span> <span class="token class-name">ObjectId</span> publishId<span class="token punctuation">;</span> <span class="token comment">//\u53D1\u5E03id</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> date<span class="token punctuation">;</span> <span class="token comment">//\u53D1\u5E03\u7684\u65F6\u95F4</span>

<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>bson<span class="token punctuation">.</span>types<span class="token punctuation">.</span></span><span class="token class-name">ObjectId</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Id</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span>mapping<span class="token punctuation">.</span></span><span class="token class-name">Document</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * \u8BC4\u8BBA\u8868
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span>collection <span class="token operator">=</span> <span class="token string">&quot;quanzi_comment&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Comment</span> <span class="token keyword">implements</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>Serializable</span><span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">291788258125767614L</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">ObjectId</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">ObjectId</span> publishId<span class="token punctuation">;</span> <span class="token comment">//\u53D1\u5E03id</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> commentType<span class="token punctuation">;</span> <span class="token comment">//\u8BC4\u8BBA\u7C7B\u578B\uFF0C1-\u70B9\u8D5E\uFF0C2-\u8BC4\u8BBA\uFF0C3-\u559C\u6B22</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span> <span class="token comment">//\u8BC4\u8BBA\u5185\u5BB9</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span> <span class="token comment">//\u8BC4\u8BBA\u4EBA</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> publishUserId<span class="token punctuation">;</span> <span class="token comment">//\u53D1\u5E03\u52A8\u6001\u7684\u7528\u6237id</span>
    <span class="token keyword">private</span> <span class="token class-name">Boolean</span> isParent <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">//\u662F\u5426\u4E3A\u7236\u8282\u70B9\uFF0C\u9ED8\u8BA4\u662F\u5426</span>
    <span class="token keyword">private</span> <span class="token class-name">ObjectId</span> parentId<span class="token punctuation">;</span> <span class="token comment">// \u7236\u8282\u70B9id</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> created<span class="token punctuation">;</span> <span class="token comment">//\u53D1\u8868\u65F6\u95F4</span>

<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-2\u3001dubbo\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_4-2\u3001dubbo\u670D\u52A1" aria-hidden="true">#</a> 4.2\u3001dubbo\u670D\u52A1</h3><p>\u5708\u5B50\u7684\u5177\u4F53\u4E1A\u52A1\u903B\u8F91\u7684\u5B9E\u73B0\u9700\u8981\u5728dubbo\u4E2D\u5B8C\u6210\uFF0C\u6240\u4EE5\u9700\u8981\u5F00\u53D1dubbo\u670D\u52A1\u3002</p><h4 id="_4-2-1\u3001\u5B9A\u4E49\u63A5\u53E3" tabindex="-1"><a class="header-anchor" href="#_4-2-1\u3001\u5B9A\u4E49\u63A5\u53E3" aria-hidden="true">#</a> 4.2.1\u3001\u5B9A\u4E49\u63A5\u53E3</h4><p>\u5728my-tanhua-dubbo-interface\u5DE5\u7A0B\u4E2D\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>api</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">Publish</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>vo<span class="token punctuation">.</span></span><span class="token class-name">PageInfo</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">QuanZiApi</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * \u67E5\u8BE2\u597D\u53CB\u52A8\u6001
     *
     * <span class="token keyword">@param</span> <span class="token parameter">userId</span> \u7528\u6237id
     * <span class="token keyword">@param</span> <span class="token parameter">page</span> \u5F53\u524D\u9875\u6570
     * <span class="token keyword">@param</span> <span class="token parameter">pageSize</span> \u6BCF\u4E00\u9875\u67E5\u8BE2\u7684\u6570\u636E\u6761\u6570
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Publish</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryPublishList</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token class-name">Integer</span> page<span class="token punctuation">,</span> <span class="token class-name">Integer</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-2-2\u3001\u5B9E\u73B0\u63A5\u53E3" tabindex="-1"><a class="header-anchor" href="#_4-2-2\u3001\u5B9E\u73B0\u63A5\u53E3" aria-hidden="true">#</a> 4.2.2\u3001\u5B9E\u73B0\u63A5\u53E3</h4><p>\u5728my-tanhua-dubbo-service\u4E2D\u5B8C\u6210\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>api</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>collection<span class="token punctuation">.</span></span><span class="token class-name">CollUtil</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">Publish</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">TimeLine</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>vo<span class="token punctuation">.</span></span><span class="token class-name">PageInfo</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>bson<span class="token punctuation">.</span>types<span class="token punctuation">.</span></span><span class="token class-name">ObjectId</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">PageRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Pageable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Sort</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">MongoTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">Criteria</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">Query</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span><span class="token punctuation">(</span>version <span class="token operator">=</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QuanZiApiImpl</span> <span class="token keyword">implements</span> <span class="token class-name">QuanZiApi</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MongoTemplate</span> mongoTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Publish</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryPublishList</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token class-name">Integer</span> page<span class="token punctuation">,</span> <span class="token class-name">Integer</span> pageSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u5206\u6790\uFF1A\u67E5\u8BE2\u597D\u53CB\u7684\u52A8\u6001\uFF0C\u5B9E\u9645\u4E0A\u67E5\u8BE2\u65F6\u95F4\u7EBF\u8868</span>
        <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Publish</span><span class="token punctuation">&gt;</span></span> pageInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageInfo<span class="token punctuation">.</span><span class="token function">setPageNum</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageInfo<span class="token punctuation">.</span><span class="token function">setPageSize</span><span class="token punctuation">(</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Pageable</span> pageable <span class="token operator">=</span> <span class="token class-name">PageRequest</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> pageSize<span class="token punctuation">,</span>
                <span class="token class-name">Sort</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span><span class="token class-name">Sort<span class="token punctuation">.</span>Order</span><span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span>pageable<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">TimeLine</span><span class="token punctuation">&gt;</span></span> timeLineList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">TimeLine</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token string">&quot;quanzi_time_line_&quot;</span> <span class="token operator">+</span> userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>timeLineList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//\u6CA1\u6709\u67E5\u8BE2\u5230\u6570\u636E</span>
            <span class="token keyword">return</span> pageInfo<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//\u83B7\u53D6\u65F6\u95F4\u7EBF\u5217\u8868\u4E2D\u7684\u53D1\u5E03id\u7684\u5217\u8868</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> ids <span class="token operator">=</span> <span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">getFieldValues</span><span class="token punctuation">(</span>timeLineList<span class="token punctuation">,</span> <span class="token string">&quot;publishId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//\u6839\u636E\u52A8\u6001id\u67E5\u8BE2\u52A8\u6001\u5217\u8868</span>
        <span class="token class-name">Query</span> queryPublish <span class="token operator">=</span> <span class="token class-name">Query</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">in</span><span class="token punctuation">(</span>ids<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token class-name">Sort</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span><span class="token class-name">Sort<span class="token punctuation">.</span>Order</span><span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">&quot;created&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Publish</span><span class="token punctuation">&gt;</span></span> publishList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>queryPublish<span class="token punctuation">,</span> <span class="token class-name">Publish</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageInfo<span class="token punctuation">.</span><span class="token function">setRecords</span><span class="token punctuation">(</span>publishList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> pageInfo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5F15\u5165Hutool\u5DE5\u5177\u5305\uFF0C\u5B98\u65B9\u6587\u6863\uFF1Ahttps://www.hutool.cn/docs/#/</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- \u5728my-tanhua\u5DE5\u7A0B\u4E2D\u5B9A\u4E49\u4F9D\u8D56 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.hutool<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hutool-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.5.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- \u5728my-tanhua-dubbo-service\u4E2D\u5F15\u5165\u4F7F\u7528 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.hutool<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hutool-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-2-3\u3001\u6D4B\u8BD5\u7528\u4F8B" tabindex="-1"><a class="header-anchor" href="#_4-2-3\u3001\u6D4B\u8BD5\u7528\u4F8B" aria-hidden="true">#</a> 4.2.3\u3001\u6D4B\u8BD5\u7528\u4F8B</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>api</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">Publish</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>vo<span class="token punctuation">.</span></span><span class="token class-name">PageInfo</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runner<span class="token punctuation">.</span></span><span class="token class-name">RunWith</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span></span><span class="token class-name">SpringRunner</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestQuanZiApi</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">QuanZiApi</span> quanZiApi<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQueryPublishList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>quanZiApi<span class="token punctuation">.</span><span class="token function">queryPublishList</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">getRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>publish <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>publish<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>quanZiApi<span class="token punctuation">.</span><span class="token function">queryPublishList</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">getRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>publish <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>publish<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>quanZiApi<span class="token punctuation">.</span><span class="token function">queryPublishList</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">getRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>publish <span class="token operator">-&gt;</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>publish<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6D4B\u8BD5\u7ED3\u679C\uFF1A <img src="`+u+`" alt="image-20201214105907912"></p><h3 id="_4-3\u3001app\u63A5\u53E3\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_4-3\u3001app\u63A5\u53E3\u670D\u52A1" aria-hidden="true">#</a> 4.3\u3001APP\u63A5\u53E3\u670D\u52A1</h3><p>\u5F00\u53D1\u5B8C\u6210dubbo\u670D\u52A1\u540E\uFF0C\u6211\u4EEC\u5C06\u5F00\u53D1APP\u7AEF\u7684\u63A5\u53E3\u670D\u52A1\uFF0C\u4F9D\u7136\u662F\u9700\u8981\u6309\u7167mock\u63A5\u53E3\u7684\u4E2D\u7684\u63A5\u53E3\u5B9A\u4E49\u5B9E\u73B0\u3002</p><p>\u63A5\u53E3\u5730\u5740\uFF1Ahttps://mock-java.itheima.net/project/35/interface/api/683</p><h4 id="_4-3-1\u3001quanzivo" tabindex="-1"><a class="header-anchor" href="#_4-3-1\u3001quanzivo" aria-hidden="true">#</a> 4.3.1\u3001QuanZiVo</h4><p>\u6839\u636E\u63A5\u53E3\u4E2D\u54CD\u5E94\u7684\u6570\u636E\u7ED3\u6784\u8FDB\u884C\u5B9A\u4E49vo\u5BF9\u8C61\uFF1A(\u5728my-tanhua-server\u5DE5\u7A0B\u4E2D)</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>server<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QuanZiVo</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span> <span class="token comment">//\u52A8\u6001id</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span> <span class="token comment">//\u7528\u6237id</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> avatar<span class="token punctuation">;</span> <span class="token comment">//\u5934\u50CF</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> nickname<span class="token punctuation">;</span> <span class="token comment">//\u6635\u79F0</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> gender<span class="token punctuation">;</span> <span class="token comment">//\u6027\u522B man woman</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span> <span class="token comment">//\u5E74\u9F84</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> tags<span class="token punctuation">;</span> <span class="token comment">//\u6807\u7B7E</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> textContent<span class="token punctuation">;</span> <span class="token comment">//\u6587\u5B57\u52A8\u6001</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> imageContent<span class="token punctuation">;</span> <span class="token comment">//\u56FE\u7247\u52A8\u6001</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> distance<span class="token punctuation">;</span> <span class="token comment">//\u8DDD\u79BB</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> createDate<span class="token punctuation">;</span> <span class="token comment">//\u53D1\u5E03\u65F6\u95F4 \u5982: 10\u5206\u949F\u524D</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> likeCount<span class="token punctuation">;</span> <span class="token comment">//\u70B9\u8D5E\u6570</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> commentCount<span class="token punctuation">;</span> <span class="token comment">//\u8BC4\u8BBA\u6570</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> loveCount<span class="token punctuation">;</span> <span class="token comment">//\u559C\u6B22\u6570</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> hasLiked<span class="token punctuation">;</span> <span class="token comment">//\u662F\u5426\u70B9\u8D5E\uFF081\u662F\uFF0C0\u5426\uFF09</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> hasLoved<span class="token punctuation">;</span> <span class="token comment">//\u662F\u5426\u559C\u6B22\uFF081\u662F\uFF0C0\u5426\uFF09</span>

<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-3-2\u3001quanzicontroller" tabindex="-1"><a class="header-anchor" href="#_4-3-2\u3001quanzicontroller" aria-hidden="true">#</a> 4.3.2\u3001QuanZiController</h4><p>\u6839\u636E\u670D\u52A1\u63A5\u53E3\u7F16\u5199QuanZiController\uFF0C\u5176\u8BF7\u6C42\u65B9\u6CD5\u4E3AGET\u8BF7\u6C42\uFF0C\u4F1A\u4F20\u9012page\u3001pageSize\u3001token\u7B49\u4FE1\u606F\u3002</p><p>\u4EE3\u7801\u5B9E\u73B0\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>server<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">QuanZiService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>server<span class="token punctuation">.</span>vo<span class="token punctuation">.</span></span><span class="token class-name">PageResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;movements&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QuanZiController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">QuanZiService</span> quanZiService<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * \u67E5\u8BE2\u597D\u53CB\u52A8\u6001
     *
     * <span class="token keyword">@param</span> <span class="token parameter">page</span>
     * <span class="token keyword">@param</span> <span class="token parameter">pageSize</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@GetMapping</span>
    <span class="token keyword">public</span> <span class="token class-name">PageResult</span> <span class="token function">queryPublishList</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;page&quot;</span><span class="token punctuation">,</span> defaultValue <span class="token operator">=</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> page<span class="token punctuation">,</span>
                                       <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;pagesize&quot;</span><span class="token punctuation">,</span> defaultValue <span class="token operator">=</span> <span class="token string">&quot;10&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> pageSize<span class="token punctuation">,</span>
                                       <span class="token annotation punctuation">@RequestHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Authorization&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quanZiService<span class="token punctuation">.</span><span class="token function">queryPublishList</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> pageSize<span class="token punctuation">,</span> token<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-3-3\u3001quanziservice" tabindex="-1"><a class="header-anchor" href="#_4-3-3\u3001quanziservice" aria-hidden="true">#</a> 4.3.3\u3001QuanZiService</h4><p>\u5728QuanZiService\u4E2D\u5C06\u5B9E\u73B0\u5177\u4F53\u7684\u4E1A\u52A1\u903B\u8F91\uFF0C\u9700\u8981\u8C03\u7528quanzi\u7684dubbo\u670D\u52A1\u5B8C\u6210\u6570\u636E\u7684\u67E5\u8BE2\uFF0C\u5E76\u4E14\u8981\u5B8C\u6210\u7528\u6237\u767B\u5F55\u662F\u5426\u6709\u6548\u7684\u6821\u9A8C\uFF0C\u6700\u540E\u6309\u7167\u670D\u52A1\u63A5\u53E3\u4E2D\u5B9A\u4E49\u7684\u7ED3\u6784\u8FDB\u884C\u5C01\u88C5\u6570\u636E\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token class-name">BeanUtil</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>collection<span class="token punctuation">.</span></span><span class="token class-name">CollUtil</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">StrUtil</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Reference</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>common<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>common<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">UserInfo</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>common<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">RelativeDateFormat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">QuanZiApi</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">Publish</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>vo<span class="token punctuation">.</span></span><span class="token class-name">PageInfo</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>server<span class="token punctuation">.</span>vo<span class="token punctuation">.</span></span><span class="token class-name">PageResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>server<span class="token punctuation">.</span>vo<span class="token punctuation">.</span></span><span class="token class-name">QuanZiVo</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>lang3<span class="token punctuation">.</span></span><span class="token class-name">StringUtils</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QuanZiService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Reference</span><span class="token punctuation">(</span>version <span class="token operator">=</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">QuanZiApi</span> quanZiApi<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserInfoService</span> userInfoService<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">PageResult</span> <span class="token function">queryPublishList</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> page<span class="token punctuation">,</span> <span class="token class-name">Integer</span> pageSize<span class="token punctuation">,</span> <span class="token class-name">String</span> token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u5206\u6790\uFF1A\u901A\u8FC7dubbo\u4E2D\u7684\u670D\u52A1\u67E5\u8BE2\u7528\u6237\u7684\u597D\u53CB\u52A8\u6001</span>
        <span class="token comment">//\u901A\u8FC7mysql\u67E5\u8BE2\u7528\u6237\u7684\u4FE1\u606F\uFF0C\u56DE\u5199\u5230\u7ED3\u679C\u5BF9\u8C61\u4E2D\uFF08QuanZiVo\uFF09</span>

        <span class="token class-name">PageResult</span> pageResult <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageResult<span class="token punctuation">.</span><span class="token function">setPage</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageResult<span class="token punctuation">.</span><span class="token function">setPagesize</span><span class="token punctuation">(</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//\u6821\u9A8Ctoken\u662F\u5426\u6709\u6548</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">queryUserByToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>user <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//token\u5DF2\u7ECF\u5931\u6548</span>
            <span class="token keyword">return</span> pageResult<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//\u901A\u8FC7dubbo\u67E5\u8BE2\u6570\u636E</span>
        <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Publish</span><span class="token punctuation">&gt;</span></span> pageInfo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quanZiApi<span class="token punctuation">.</span><span class="token function">queryPublishList</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> page<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Publish</span><span class="token punctuation">&gt;</span></span> records <span class="token operator">=</span> pageInfo<span class="token punctuation">.</span><span class="token function">getRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>records<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> pageResult<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">QuanZiVo</span><span class="token punctuation">&gt;</span></span> quanZiVoList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        records<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>publish <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">QuanZiVo</span> quanZiVo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QuanZiVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            quanZiVo<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>publish<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHexString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            quanZiVo<span class="token punctuation">.</span><span class="token function">setTextContent</span><span class="token punctuation">(</span>publish<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            quanZiVo<span class="token punctuation">.</span><span class="token function">setImageContent</span><span class="token punctuation">(</span>publish<span class="token punctuation">.</span><span class="token function">getMedias</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            quanZiVo<span class="token punctuation">.</span><span class="token function">setUserId</span><span class="token punctuation">(</span>publish<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            quanZiVo<span class="token punctuation">.</span><span class="token function">setCreateDate</span><span class="token punctuation">(</span><span class="token class-name">RelativeDateFormat</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>publish<span class="token punctuation">.</span><span class="token function">getCreated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            quanZiVoList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>quanZiVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//\u67E5\u8BE2\u7528\u6237\u4FE1\u606F</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> userIds <span class="token operator">=</span> <span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">getFieldValues</span><span class="token punctuation">(</span>records<span class="token punctuation">,</span> <span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> userInfoList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userInfoService<span class="token punctuation">.</span><span class="token function">queryUserInfoByUserIdList</span><span class="token punctuation">(</span>userIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">QuanZiVo</span> quanZiVo <span class="token operator">:</span> quanZiVoList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//\u627E\u5230\u5BF9\u5E94\u7684\u7528\u6237\u4FE1\u606F</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">UserInfo</span> userInfo <span class="token operator">:</span> userInfoList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>quanZiVo<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">longValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> userInfo<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">longValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fillUserInfoToQuanZiVo</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">,</span> quanZiVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        pageResult<span class="token punctuation">.</span><span class="token function">setItems</span><span class="token punctuation">(</span>quanZiVoList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> pageResult<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u586B\u5145\u7528\u6237\u4FE1\u606F
     *
     * <span class="token keyword">@param</span> <span class="token parameter">userInfo</span>
     * <span class="token keyword">@param</span> <span class="token parameter">quanZiVo</span>
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">fillUserInfoToQuanZiVo</span><span class="token punctuation">(</span><span class="token class-name">UserInfo</span> userInfo<span class="token punctuation">,</span> <span class="token class-name">QuanZiVo</span> quanZiVo<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">BeanUtil</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">,</span> quanZiVo<span class="token punctuation">,</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        quanZiVo<span class="token punctuation">.</span><span class="token function">setGender</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">.</span><span class="token function">getSex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        quanZiVo<span class="token punctuation">.</span><span class="token function">setTags</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">.</span><span class="token function">getTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token char">&#39;,&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        quanZiVo<span class="token punctuation">.</span><span class="token function">setCommentCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//TODO \u8BC4\u8BBA\u6570</span>
        quanZiVo<span class="token punctuation">.</span><span class="token function">setDistance</span><span class="token punctuation">(</span><span class="token string">&quot;1.2\u516C\u91CC&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//TODO \u8DDD\u79BB</span>
        quanZiVo<span class="token punctuation">.</span><span class="token function">setHasLiked</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//TODO \u662F\u5426\u70B9\u8D5E\uFF081\u662F\uFF0C0\u5426\uFF09</span>
        quanZiVo<span class="token punctuation">.</span><span class="token function">setLikeCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//TODO \u70B9\u8D5E\u6570</span>
        quanZiVo<span class="token punctuation">.</span><span class="token function">setHasLoved</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//TODO \u662F\u5426\u559C\u6B22\uFF081\u662F\uFF0C0\u5426\uFF09</span>
        quanZiVo<span class="token punctuation">.</span><span class="token function">setLoveCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//TODO \u559C\u6B22\u6570</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// com.tanhua.server.service.UserInfoService</span>
	<span class="token doc-comment comment">/**
     * \u6839\u636E\u7528\u6237id\u7684\u96C6\u5408\u67E5\u8BE2\u7528\u6237\u5217\u8868
     *
     * <span class="token keyword">@param</span> <span class="token parameter">userIds</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryUserInfoList</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> userIds<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> queryWrapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        queryWrapper<span class="token punctuation">.</span><span class="token function">in</span><span class="token punctuation">(</span><span class="token string">&quot;user_id&quot;</span><span class="token punctuation">,</span> userIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">queryUserInfoList</span><span class="token punctuation">(</span>queryWrapper<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728com.tanhua.server.vo.QuanZiVo\u4E2D\u589E\u52A0\u5B57\u6BB5\u522B\u540D\uFF0C\u65B9\u4FBF\u76F4\u63A5\u62F7\u8D1D\u5C5E\u6027\u6570\u636E\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>server<span class="token punctuation">.</span>vo</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Alias</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">QuanZiVo</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span> <span class="token comment">//\u52A8\u6001id</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span> <span class="token comment">//\u7528\u6237id</span>
    <span class="token annotation punctuation">@Alias</span><span class="token punctuation">(</span><span class="token string">&quot;logo&quot;</span><span class="token punctuation">)</span> <span class="token comment">//\u522B\u540D</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> avatar<span class="token punctuation">;</span> <span class="token comment">//\u5934\u50CF</span>
    <span class="token annotation punctuation">@Alias</span><span class="token punctuation">(</span><span class="token string">&quot;nickName&quot;</span><span class="token punctuation">)</span> <span class="token comment">//\u522B\u540D</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> nickname<span class="token punctuation">;</span> <span class="token comment">//\u6635\u79F0</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> gender<span class="token punctuation">;</span> <span class="token comment">//\u6027\u522B man woman</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span> <span class="token comment">//\u5E74\u9F84</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> tags<span class="token punctuation">;</span> <span class="token comment">//\u6807\u7B7E</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> textContent<span class="token punctuation">;</span> <span class="token comment">//\u6587\u5B57\u52A8\u6001</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> imageContent<span class="token punctuation">;</span> <span class="token comment">//\u56FE\u7247\u52A8\u6001</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> distance<span class="token punctuation">;</span> <span class="token comment">//\u8DDD\u79BB</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> createDate<span class="token punctuation">;</span> <span class="token comment">//\u53D1\u5E03\u65F6\u95F4 \u5982: 10\u5206\u949F\u524D</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> likeCount<span class="token punctuation">;</span> <span class="token comment">//\u70B9\u8D5E\u6570</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> commentCount<span class="token punctuation">;</span> <span class="token comment">//\u8BC4\u8BBA\u6570</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> loveCount<span class="token punctuation">;</span> <span class="token comment">//\u559C\u6B22\u6570</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> hasLiked<span class="token punctuation">;</span> <span class="token comment">//\u662F\u5426\u70B9\u8D5E\uFF081\u662F\uFF0C0\u5426\uFF09</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> hasLoved<span class="token punctuation">;</span> <span class="token comment">//\u662F\u5426\u559C\u6B22\uFF081\u662F\uFF0C0\u5426\uFF09</span>

<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-3-4\u3001\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#_4-3-4\u3001\u6D4B\u8BD5" aria-hidden="true">#</a> 4.3.4\u3001\u6D4B\u8BD5</h4><p><img src="`+k+'" alt="image-20201209162304889"></p><h2 id="_5\u3001\u7EDF\u4E00\u6821\u9A8Ctoken" tabindex="-1"><a class="header-anchor" href="#_5\u3001\u7EDF\u4E00\u6821\u9A8Ctoken" aria-hidden="true">#</a> 5\u3001\u7EDF\u4E00\u6821\u9A8Ctoken</h2><p>\u5728\u4E4B\u524D\u7684\u5F00\u53D1\u4E2D\uFF0C\u6211\u4EEC\u4F1A\u5728\u6BCF\u4E00\u4E2AService\u4E2D\u5BF9token\u505A\u5904\u7406\uFF0C\u76F8\u540C\u7684\u903B\u8F91\u4E00\u5B9A\u662F\u8981\u8FDB\u884C\u7EDF\u4E00\u5904\u7406\u7684\uFF0C\u8BE5\u5982\u4F55\u5904\u7406\u5462\uFF1F</p><p>\u7531\u4E8E\u7A0B\u5E8F\u662F\u8FD0\u884C\u5728web\u5BB9\u5668\u4E2D\uFF0C\u6BCF\u4E00\u4E2AHTTP\u8BF7\u6C42\u90FD\u662F\u4E00\u4E2A\u72EC\u7ACB\u7EBF\u7A0B\uFF0C\u4E5F\u5C31\u662F\u53EF\u4EE5\u7406\u89E3\u6210\u6211\u4EEC\u7F16\u5199\u7684\u5E94\u7528\u7A0B\u5E8F\u8FD0\u884C\u5728\u4E00\u4E2A\u591A\u7EBF\u7A0B\u7684\u73AF\u5883\u4E2D\uFF0C\u90A3\u4E48\u6211\u4EEC\u5C31\u53EF\u4EE5\u4F7F\u7528ThreadLocal\u5728HTTP\u8BF7\u6C42\u7684\u751F\u547D\u5468\u671F\u5185\u8FDB\u884C\u5B58\u503C\u3001\u53D6\u503C\u64CD\u4F5C\u3002</p><p>\u5982\u4E0B\u56FE\uFF1A</p><p><img src="'+r+`" alt="image-20201209195645804"></p><p>\u8BF4\u660E\uFF1A</p><ul><li>\u7528\u6237\u7684\u6BCF\u4E00\u4E2A\u8BF7\u6C42\uFF0C\u90FD\u662F\u4E00\u4E2A\u72EC\u7ACB\u7684\u7EBF\u7A0B</li><li>\u56FE\u4E2D\u7684TL\u5C31\u662FThreadLocal\uFF0C\u4E00\u65E6\u5C06\u6570\u636E\u7ED1\u5B9A\u5230ThreadLocal\u4E2D\uFF0C\u90A3\u4E48\u5728\u6574\u4E2A\u8BF7\u6C42\u7684\u751F\u547D\u5468\u671F\u5185\u90FD\u53EF\u4EE5\u968F\u65F6\u62FF\u5230ThreadLocal\u4E2D\u5F53\u524D\u7EBF\u7A0B\u7684\u6570\u636E\u3002</li></ul><p>\u6839\u636E\u4E0A\u9762\u7684\u5206\u6790\uFF0C\u6211\u4EEC\u53EA\u9700\u8981\u5728Controller\u8BF7\u6C42\u4E4B\u524D\u8FDB\u884C\u5BF9token\u505A\u6821\u9A8C\uFF0C\u5982\u679Ctoken\u6709\u6548\uFF0C\u5219\u4F1A\u62FF\u5230User\u5BF9\u8C61\uFF0C\u7136\u540E\u5C06\u8BE5User\u5BF9\u8C61\u4FDD\u5B58\u5230ThreadLocal\u4E2D\u5373\u53EF\uFF0C\u6700\u540E\u653E\u884C\u8BF7\u6C42\uFF0C\u5728\u540E\u7EED\u7684\u5404\u4E2A\u73AF\u8282\u4E2D\u90FD\u53EF\u4EE5\u83B7\u53D6\u5230\u8BE5\u6570\u636E\u4E86\u3002</p><p>\u5982\u679Ctoken\u65E0\u6548\uFF0C\u7ED9\u5BA2\u6237\u7AEF\u54CD\u5E94401\u72B6\u6001\u7801\uFF0C\u62E6\u622A\u8BF7\u6C42\uFF0C\u4E0D\u518D\u653E\u884C\u5230Controller\u4E2D\u3002</p><p>\u7531\u6B64\u53EF\u89C1\uFF0C\u8FD9\u4E2A\u6821\u9A8C\u7684\u903B\u8F91\u662F\u6BD4\u8F83\u9002\u5408\u653E\u5728\u62E6\u622A\u5668\u4E2D\u5B8C\u6210\u7684\u3002</p><h3 id="_5-1\u3001\u7F16\u5199userthreadlocal" tabindex="-1"><a class="header-anchor" href="#_5-1\u3001\u7F16\u5199userthreadlocal" aria-hidden="true">#</a> 5.1\u3001\u7F16\u5199UserThreadLocal</h3><p>\u5728my-tanhua-common\u5DE5\u7A0B\u4E2D\uFF0C\u7F16\u5199UserThreadLocal\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>common<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>common<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserThreadLocal</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token constant">LOCAL</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">UserThreadLocal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5C06\u5BF9\u8C61\u653E\u5165\u5230ThreadLocal
     *
     * <span class="token keyword">@param</span> <span class="token parameter">user</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token constant">LOCAL</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u8FD4\u56DE\u5F53\u524D\u7EBF\u7A0B\u4E2D\u7684User\u5BF9\u8C61
     *
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">User</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token constant">LOCAL</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5220\u9664\u5F53\u524D\u7EBF\u7A0B\u4E2D\u7684User\u5BF9\u8C61
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token constant">LOCAL</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-2\u3001\u7F16\u5199tokeninterceptor" tabindex="-1"><a class="header-anchor" href="#_5-2\u3001\u7F16\u5199tokeninterceptor" aria-hidden="true">#</a> 5.2\u3001\u7F16\u5199TokenInterceptor</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>server<span class="token punctuation">.</span>interceptor</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">StrUtil</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>common<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">User</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>common<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">NoAuthorization</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>common<span class="token punctuation">.</span>utils<span class="token punctuation">.</span></span><span class="token class-name">UserThreadLocal</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">UserService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>method<span class="token punctuation">.</span></span><span class="token class-name">HandlerMethod</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">HandlerInterceptor</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserTokenInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerInterceptor</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u6821\u9A8Chandler\u662F\u5426\u662FHandlerMethod</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>handler <span class="token keyword">instanceof</span> <span class="token class-name">HandlerMethod</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//\u5224\u65AD\u662F\u5426\u5305\u542B@NoAuthorization\u6CE8\u89E3\uFF0C\u5982\u679C\u5305\u542B\uFF0C\u76F4\u63A5\u653E\u884C</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">HandlerMethod</span><span class="token punctuation">)</span> handler<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasMethodAnnotation</span><span class="token punctuation">(</span><span class="token class-name">NoAuthorization</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//\u4ECE\u8BF7\u6C42\u5934\u4E2D\u83B7\u53D6token</span>
        <span class="token class-name">String</span> token <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Authorization&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">queryUserByToken</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>user <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token comment">//token\u6709\u6548</span>
                <span class="token comment">//\u5C06User\u5BF9\u8C61\u653E\u5165\u5230ThreadLocal\u4E2D</span>
                <span class="token class-name">UserThreadLocal</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//token\u65E0\u6548\uFF0C\u54CD\u5E94\u72B6\u6001\u4E3A401</span>
        response<span class="token punctuation">.</span><span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token number">401</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u65E0\u6743\u9650</span>

        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterCompletion</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u4ECEThreadLocal\u4E2D\u79FB\u9664User\u5BF9\u8C61</span>
        <span class="token class-name">UserThreadLocal</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-3\u3001\u7F16\u5199\u6CE8\u89E3noauthorization" tabindex="-1"><a class="header-anchor" href="#_5-3\u3001\u7F16\u5199\u6CE8\u89E3noauthorization" aria-hidden="true">#</a> 5.3\u3001\u7F16\u5199\u6CE8\u89E3NoAuthorization</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>common<span class="token punctuation">.</span>utils</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Documented</span> <span class="token comment">//\u6807\u8BB0\u6CE8\u89E3</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">NoAuthorization</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-4\u3001\u6CE8\u518C\u62E6\u622A\u5668" tabindex="-1"><a class="header-anchor" href="#_5-4\u3001\u6CE8\u518C\u62E6\u622A\u5668" aria-hidden="true">#</a> 5.4\u3001\u6CE8\u518C\u62E6\u622A\u5668</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>server<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>server<span class="token punctuation">.</span>interceptor<span class="token punctuation">.</span></span><span class="token class-name">RedisCacheInterceptor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>server<span class="token punctuation">.</span>interceptor<span class="token punctuation">.</span></span><span class="token class-name">UserTokenInterceptor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">InterceptorRegistry</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">WebMvcConfigurer</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WebConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RedisCacheInterceptor</span> redisCacheInterceptor<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserTokenInterceptor</span> userTokenInterceptor<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addInterceptors</span><span class="token punctuation">(</span><span class="token class-name">InterceptorRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u8003\u8651\u62E6\u622A\u5668\u7684\u987A\u5E8F</span>
        registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>userTokenInterceptor<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addPathPatterns</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>redisCacheInterceptor<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addPathPatterns</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-5\u3001\u4F7F\u7528threadlocal" tabindex="-1"><a class="header-anchor" href="#_5-5\u3001\u4F7F\u7528threadlocal" aria-hidden="true">#</a> 5.5\u3001\u4F7F\u7528ThreadLocal</h3><p>\u5728\u6240\u6709\u7684Service\u4E2D\uFF0C\u5982\u679C\u9700\u8981\u83B7\u53D6User\u5BF9\u8C61\u7684\uFF0C\u76F4\u63A5\u4ECEUserThreadLocal\u83B7\u53D6\u5373\u53EF\uFF0C\u540C\u65F6\u5728Controller\u4E2D\u4E5F\u65E0\u9700\u8FDB\u884C\u83B7\u53D6token\u64CD\u4F5C\u3002</p><p>\u4F8B\u5982\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//com.tanhua.server.service.QuanZiService</span>

<span class="token keyword">public</span> <span class="token class-name">PageResult</span> <span class="token function">queryPublishList</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> page<span class="token punctuation">,</span> <span class="token class-name">Integer</span> pageSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">PageResult</span> pageResult <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageResult<span class="token punctuation">.</span><span class="token function">setPage</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageResult<span class="token punctuation">.</span><span class="token function">setPagesize</span><span class="token punctuation">(</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//\u83B7\u53D6User\u5BF9\u8C61\uFF0C\u65E0\u9700\u5BF9User\u5BF9\u8C61\u6821\u9A8C\uFF0C\u5176\u4E00\u5B9A\u4E0D\u4E3Anull</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token class-name">UserThreadLocal</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Publish</span><span class="token punctuation">&gt;</span></span> pageInfo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quanZiApi<span class="token punctuation">.</span><span class="token function">queryPublishList</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> page<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
       <span class="token comment">//\u3002\u3002\u3002\u3002\u4EE3\u7801\u7565\u3002\u3002\u3002\u3002\u3002</span>

        <span class="token keyword">return</span> pageResult<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0C\u5728APP\u4E2D\uFF0C\u5982\u679C\u8BF7\u6C42\u54CD\u5E94401\uFF0C\u4F1A\u8DF3\u8F6C\u5230\u767B\u5F55\u9875\u9762\u3002</p><h2 id="_6\u3001\u53D1\u5E03\u52A8\u6001" tabindex="-1"><a class="header-anchor" href="#_6\u3001\u53D1\u5E03\u52A8\u6001" aria-hidden="true">#</a> 6\u3001\u53D1\u5E03\u52A8\u6001</h2><p>\u7528\u6237\u53EF\u4EE5\u5728\u5708\u5B50\u4E2D\u53D1\u5E03\u52A8\u6001\uFF0C\u52A8\u6001\u5185\u5BB9\u4E2D\u53EF\u4EE5\u6709\u6587\u5B57\u548C\u56FE\u7247\u3002\u5982\u4E0B\u56FE\uFF1A</p><img src="`+d+`" alt="\u4E3B\u9875\u9762-\u4E00\u671F-\u6DFB\u52A0\u56FE\u7247\u540E" style="zoom:25%;"><h3 id="_6-1\u3001dubbo\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_6-1\u3001dubbo\u670D\u52A1" aria-hidden="true">#</a> 6.1\u3001dubbo\u670D\u52A1</h3><h4 id="_6-1-1\u3001\u5B9A\u4E49\u63A5\u53E3" tabindex="-1"><a class="header-anchor" href="#_6-1-1\u3001\u5B9A\u4E49\u63A5\u53E3" aria-hidden="true">#</a> 6.1.1\u3001\u5B9A\u4E49\u63A5\u53E3</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>api</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">Publish</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>vo<span class="token punctuation">.</span></span><span class="token class-name">PageInfo</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">QuanZiApi</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * \u67E5\u8BE2\u597D\u53CB\u52A8\u6001
     *
     * <span class="token keyword">@param</span> <span class="token parameter">userId</span> \u7528\u6237id
     * <span class="token keyword">@param</span> <span class="token parameter">page</span> \u5F53\u524D\u9875\u6570
     * <span class="token keyword">@param</span> <span class="token parameter">pageSize</span> \u6BCF\u4E00\u9875\u67E5\u8BE2\u7684\u6570\u636E\u6761\u6570
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Publish</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryPublishList</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token class-name">Integer</span> page<span class="token punctuation">,</span> <span class="token class-name">Integer</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * \u53D1\u5E03\u52A8\u6001
     *
     * <span class="token keyword">@param</span> <span class="token parameter">publish</span>
     * <span class="token keyword">@return</span> \u53D1\u5E03\u6210\u529F\u8FD4\u56DE\u52A8\u6001id
     */</span>
    <span class="token class-name">String</span> <span class="token function">savePublish</span><span class="token punctuation">(</span><span class="token class-name">Publish</span> publish<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-1-2\u3001\u5B9E\u73B0\u63A5\u53E3" tabindex="-1"><a class="header-anchor" href="#_6-1-2\u3001\u5B9E\u73B0\u63A5\u53E3" aria-hidden="true">#</a> 6.1.2\u3001\u5B9E\u73B0\u63A5\u53E3</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token doc-comment comment">/**
     * \u53D1\u5E03\u52A8\u6001
     *
     * <span class="token keyword">@param</span> <span class="token parameter">publish</span>
     * <span class="token keyword">@return</span> \u53D1\u5E03\u6210\u529F\u8FD4\u56DE\u52A8\u6001id
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">savePublish</span><span class="token punctuation">(</span><span class="token class-name">Publish</span> publish<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u5BF9publish\u5BF9\u8C61\u6821\u9A8C</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">ObjectUtil</span><span class="token punctuation">.</span><span class="token function">isAllNotEmpty</span><span class="token punctuation">(</span>publish<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> publish<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//\u53D1\u5E03\u5931\u8D25</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//\u8BBE\u7F6E\u4E3B\u952Eid</span>
        publish<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">ObjectId</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//\u8BBE\u7F6E\u81EA\u589E\u957F\u7684pid</span>
            publish<span class="token punctuation">.</span><span class="token function">setPid</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>idService<span class="token punctuation">.</span><span class="token function">createId</span><span class="token punctuation">(</span><span class="token class-name">IdType</span><span class="token punctuation">.</span><span class="token constant">PUBLISH</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            publish<span class="token punctuation">.</span><span class="token function">setCreated</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//\u5199\u5165\u5230publish\u8868\u4E2D</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>publish<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//\u5199\u5165\u76F8\u518C\u8868</span>
            <span class="token class-name">Album</span> album <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Album</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            album<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">ObjectId</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            album<span class="token punctuation">.</span><span class="token function">setCreated</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            album<span class="token punctuation">.</span><span class="token function">setPublishId</span><span class="token punctuation">(</span>publish<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>album<span class="token punctuation">,</span> <span class="token string">&quot;quanzi_album_&quot;</span> <span class="token operator">+</span> publish<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//\u5199\u5165\u597D\u53CB\u7684\u65F6\u95F4\u7EBF\u8868\uFF08\u5F02\u6B65\u5199\u5165\uFF09</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>timeLineService<span class="token punctuation">.</span><span class="token function">saveTimeLine</span><span class="token punctuation">(</span>publish<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> publish<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//TODO \u9700\u8981\u505A\u4E8B\u52A1\u7684\u56DE\u6EDA\uFF0CMongodb\u7684\u5355\u8282\u70B9\u670D\u52A1\uFF0C\u4E0D\u652F\u6301\u4E8B\u52A1\uFF0C\u5BF9\u4E8E\u56DE\u6EDA\u6211\u4EEC\u6682\u65F6\u4E0D\u5B9E\u73B0\u4E86</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;\u53D1\u5E03\u52A8\u6001\u5931\u8D25~ publish = &quot;</span> <span class="token operator">+</span> publish<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> publish<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHexString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>enums<span class="token punctuation">.</span></span><span class="token class-name">IdType</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RedisTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token comment">//\u751F\u6210\u81EA\u589E\u957F\u7684id\uFF0C\u539F\u7406\uFF1A\u4F7F\u7528redis\u7684\u81EA\u589E\u957F\u503C</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IdService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> redisTemplate<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">createId</span><span class="token punctuation">(</span><span class="token class-name">IdType</span> idType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> idKey <span class="token operator">=</span> <span class="token string">&quot;TANHUA_ID_&quot;</span> <span class="token operator">+</span> idType<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span>idKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>enums</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">IdType</span> <span class="token punctuation">{</span>

    <span class="token constant">PUBLISH</span><span class="token punctuation">,</span> <span class="token constant">VIDEO</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-1-3\u3001\u597D\u53CB\u65F6\u95F4\u7EBF\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#_6-1-3\u3001\u597D\u53CB\u65F6\u95F4\u7EBF\u6570\u636E" aria-hidden="true">#</a> 6.1.3\u3001\u597D\u53CB\u65F6\u95F4\u7EBF\u6570\u636E</h4><p>\u597D\u53CB\u7684\u65F6\u95F4\u7EBF\u6570\u636E\u9700\u8981\u5F02\u6B65\u6267\u884C\u3002\u8FD9\u91CC\u4F7F\u7528Spring\u7684@Async\u6CE8\u89E3\u5B9E\u73B0\u5F02\u6B65\u6267\u884C\uFF0C\u5176\u5E95\u5C42\u662F\u901A\u8FC7\u542F\u52A8\u72EC\u7ACB\u7EBF\u7A0B\u6765\u6267\u884C\uFF0C\u4ECE\u800C\u53EF\u4EE5\u5F02\u6B65\u6267\u884C\u3002\u901A\u8FC7\u8FD4\u56DE\u7684CompletableFuture\u6765\u5224\u65AD\u662F\u5426\u6267\u884C\u6210\u529F\u4EE5\u53CA\u662F\u5426\u5B58\u5728\u5F02\u5E38\u3002\u540C\u65F6\u9700\u8981\u5728\u542F\u52A8\u7C7B\u4E2D\u6DFB\u52A0@EnableAsync \u5F00\u542F\u5F02\u6B65\u7684\u652F\u6301\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>collection<span class="token punctuation">.</span></span><span class="token class-name">CollUtil</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">TimeLine</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">Users</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>bson<span class="token punctuation">.</span>types<span class="token punctuation">.</span></span><span class="token class-name">ObjectId</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">MongoTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">Criteria</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>mongodb<span class="token punctuation">.</span>core<span class="token punctuation">.</span>query<span class="token punctuation">.</span></span><span class="token class-name">Query</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>scheduling<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Async</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">CompletableFuture</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TimeLineService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MongoTemplate</span> mongoTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Async</span> <span class="token comment">//\u5F02\u6B65\u6267\u884C\uFF0C\u539F\u7406\uFF1A\u5E95\u5C42\u5F00\u4E00\u4E2A\u7EBF\u7A0B\u53BB\u6267\u884C\u8BE5\u65B9\u6CD5</span>
    <span class="token keyword">public</span> <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">saveTimeLine</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token class-name">ObjectId</span> publishId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u5199\u5165\u597D\u53CB\u7684\u65F6\u95F4\u7EBF\u8868</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//\u67E5\u8BE2\u597D\u53CB\u5217\u8868</span>
            <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token class-name">Query</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Users</span><span class="token punctuation">&gt;</span></span> usersList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">Users</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>usersList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//\u8FD4\u56DE\u6210\u529F</span>
                <span class="token keyword">return</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span><span class="token string">&quot;ok&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">//\u4F9D\u6B21\u5199\u5165\u5230\u597D\u53CB\u7684\u65F6\u95F4\u7EBF\u8868\u4E2D</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Users</span> users <span class="token operator">:</span> usersList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">TimeLine</span> timeLine <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TimeLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                timeLine<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">ObjectId</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                timeLine<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                timeLine<span class="token punctuation">.</span><span class="token function">setPublishId</span><span class="token punctuation">(</span>publishId<span class="token punctuation">)</span><span class="token punctuation">;</span>
                timeLine<span class="token punctuation">.</span><span class="token function">setUserId</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//\u5199\u5165\u6570\u636E</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>timeLine<span class="token punctuation">,</span> <span class="token string">&quot;quanzi_time_line_&quot;</span> <span class="token operator">+</span> users<span class="token punctuation">.</span><span class="token function">getFriendId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;\u5199\u5165\u597D\u53CB\u65F6\u95F4\u7EBF\u8868\u5931\u8D25~ userId = &quot;</span> <span class="token operator">+</span> userId <span class="token operator">+</span> <span class="token string">&quot;, publishId = &quot;</span> <span class="token operator">+</span> publishId<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//TODO \u4E8B\u52A1\u56DE\u6EDA\u95EE\u9898</span>
            <span class="token keyword">return</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token class-name">CompletableFuture</span><span class="token punctuation">.</span><span class="token function">completedFuture</span><span class="token punctuation">(</span><span class="token string">&quot;ok&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5F00\u542F\u5F02\u6B65\u6267\u884C\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">StrUtil</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>scheduling<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">EnableAsync</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableAsync</span> <span class="token comment">//\u5F00\u542F\u5F02\u6B65\u6267\u884C\u7684\u652F\u6301</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DubboApplication</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">DubboApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-1-4\u3001\u6D4B\u8BD5\u597D\u53CB\u65F6\u95F4\u7EBF" tabindex="-1"><a class="header-anchor" href="#_6-1-4\u3001\u6D4B\u8BD5\u597D\u53CB\u65F6\u95F4\u7EBF" aria-hidden="true">#</a> 6.1.4\u3001\u6D4B\u8BD5\u597D\u53CB\u65F6\u95F4\u7EBF</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>api</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">TimeLineService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>bson<span class="token punctuation">.</span>types<span class="token punctuation">.</span></span><span class="token class-name">ObjectId</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runner<span class="token punctuation">.</span></span><span class="token class-name">RunWith</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span></span><span class="token class-name">SpringRunner</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">CompletableFuture</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">ExecutionException</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestTimeLineService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">TimeLineService</span> timeLineService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSaveTimeLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">ObjectId</span> objectId <span class="token operator">=</span> <span class="token class-name">ObjectId</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u751F\u6210\u7684id\u4E3A\uFF1A&quot;</span> <span class="token operator">+</span> objectId<span class="token punctuation">.</span><span class="token function">toHexString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CompletableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> future <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>timeLineService<span class="token punctuation">.</span><span class="token function">saveTimeLine</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span> objectId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        future<span class="token punctuation">.</span><span class="token function">whenComplete</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> throwable<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6267\u884C\u5B8C\u6210\uFF1A&quot;</span> <span class="token operator">+</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u5F02\u6B65\u65B9\u6CD5\u6267\u884C\u5B8C\u6210&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            future<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u963B\u585E\u5F53\u524D\u7684\u4E3B\u7EBF\u7A0B\uFF0C\u7B49\u5F85\u5F02\u6B65\u6267\u884C\u7684\u7ED3\u675F</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-1-5\u3001\u6D4B\u8BD5\u53D1\u5E03\u52A8\u6001" tabindex="-1"><a class="header-anchor" href="#_6-1-5\u3001\u6D4B\u8BD5\u53D1\u5E03\u52A8\u6001" aria-hidden="true">#</a> 6.1.5\u3001\u6D4B\u8BD5\u53D1\u5E03\u52A8\u6001</h4><p>\u5C06dubbo\u670D\u52A1\u542F\u52A8\u8D77\u6765\uFF0C\u5728my-tanhua-server\u5DE5\u7A0B\u4E2D\u8FDB\u884C\u529F\u80FD\u7684\u6D4B\u8BD5\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>server</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">cn<span class="token punctuation">.</span>hutool<span class="token punctuation">.</span>core<span class="token punctuation">.</span>collection<span class="token punctuation">.</span></span><span class="token class-name">ListUtil</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Reference</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>api<span class="token punctuation">.</span></span><span class="token class-name">QuanZiApi</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>server<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span><span class="token class-name">Publish</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runner<span class="token punctuation">.</span></span><span class="token class-name">RunWith</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span></span><span class="token class-name">SpringRunner</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestQuanZiApi</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Reference</span><span class="token punctuation">(</span>version <span class="token operator">=</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">QuanZiApi</span> quanZiApi<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSavePublish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">Publish</span> publish <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Publish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        publish<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">&quot;\u4EBA\u751F\u4E0D\u5982\u610F\u4E8B\u5341\u4E4B\u516B\u4E5D\uFF0C\u771F\u6B63\u6709\u683C\u5C40\u7684\u4EBA\uFF0C\u65E2\u80FD\u4EAB\u53D7\u6700\u597D\u7684\uFF0C\u4E5F\u80FD\u627F\u53D7\u6700\u574F\u7684\u3002&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        publish<span class="token punctuation">.</span><span class="token function">setMedias</span><span class="token punctuation">(</span><span class="token class-name">ListUtil</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token string">&quot;https://tanhua-dev.oss-cn-zhangjiakou.aliyuncs.com/photo/6/1.jpg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;https://tanhua-dev.oss-cn-zhangjiakou.aliyuncs.com/photo/6/CL-3.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        publish<span class="token punctuation">.</span><span class="token function">setUserId</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        publish<span class="token punctuation">.</span><span class="token function">setSeeType</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        publish<span class="token punctuation">.</span><span class="token function">setLongitude</span><span class="token punctuation">(</span><span class="token string">&quot;116.350426&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        publish<span class="token punctuation">.</span><span class="token function">setLatitude</span><span class="token punctuation">(</span><span class="token string">&quot;40.066355&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        publish<span class="token punctuation">.</span><span class="token function">setLocationName</span><span class="token punctuation">(</span><span class="token string">&quot;\u4E2D\u56FD\u5317\u4EAC\u5E02\u660C\u5E73\u533A\u5EFA\u6750\u57CE\u897F\u8DEF16\u53F7&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>quanZiApi<span class="token punctuation">.</span><span class="token function">savePublish</span><span class="token punctuation">(</span>publish<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-2\u3001app\u63A5\u53E3\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_6-2\u3001app\u63A5\u53E3\u670D\u52A1" aria-hidden="true">#</a> 6.2\u3001APP\u63A5\u53E3\u670D\u52A1</h3><p>\u63A5\u53E3\u5730\u5740\uFF1Ahttps://mock-java.itheima.net/project/35/interface/api/701</p><p><img src="`+m+'" alt="image-20201210173432543"></p><p>\u4ECE\u63A5\u53E3\u4E2D\u53EF\u4EE5\u770B\u51FA\uFF0C\u4E3B\u8981\u7684\u53C2\u6570\u6709\uFF1A\u6587\u5B57\u3001\u56FE\u7247\u3001\u4F4D\u7F6E\u7B49\u5185\u5BB9\u3002</p><h4 id="_6-2-1\u3001\u56FE\u7247\u4E0A\u4F20" tabindex="-1"><a class="header-anchor" href="#_6-2-1\u3001\u56FE\u7247\u4E0A\u4F20" aria-hidden="true">#</a> 6.2.1\u3001\u56FE\u7247\u4E0A\u4F20</h4><p>\u56FE\u7247\u4E0A\u4F20\u529F\u80FD\u539F\u6765\u662F\u5728sso\u4E2D\u5B8C\u6210\u7684\uFF0C\u4E3A\u4E86\u80FD\u516C\u7528\u8BE5\u529F\u80FD\uFF0C\u6240\u4EE5\u9700\u8981\u5C06\u56FE\u7247\u4E0A\u4F20\u7684Service\u4EE5\u53CA\u914D\u7F6E\u79FB\u52A8\u81F3common\u5DE5\u7A0B\u4E2D\u3002</p><p><img src="'+v+`" alt="image-20201210213548508"></p><p>pom.xml\uFF1A</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>my-tanhua<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.itcast.tanhua<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>my-tanhua-common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-plus-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.fasterxml.jackson.core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jackson-databind<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.aliyun.oss<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>aliyun-sdk-oss<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>commons-lang3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>joda-time<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>joda-time<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u9700\u8981\u6CE8\u610F3\u70B9\uFF1A</p><ul><li><p>\u5C06sso\u7CFB\u7EDF\u4E2D\u7684\u76F8\u5173\u4EE3\u7801\u5220\u9664</p></li><li><p>\u5C06aliyun.properties\u590D\u5236\u5230my-tanhua-server\u4E2D</p></li><li><p>\u542F\u52A8\u7C7B\u4E2D\u9700\u8981\u5C06\u5305\u626B\u63CF\u8303\u56F4\u6269\u5927\u5230comm.tanhua\uFF0C\u56E0\u4E3A\u76F8\u5173\u7C7B\u88AB\u79FB\u52A8\u5230com.tanhua.common\u4E0B\uFF0C\u9ED8\u8BA4\u626B\u63CF\u4E0D\u80FD\u88AB\u626B\u63CF\u5230\u3002</p><ul><li><p>sso\u4E0Eserver\u7CFB\u7EDF\u90FD\u9700\u8981\u8BBE\u7F6E\uFF1A</p></li><li><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tanhua<span class="token punctuation">.</span>server</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span><span class="token string">&quot;com.tanhua.common.mapper&quot;</span><span class="token punctuation">)</span> <span class="token comment">//\u8BBE\u7F6Emapper\u63A5\u53E3\u7684\u626B\u63CF\u5305</span>
<span class="token annotation punctuation">@SpringBootApplication</span><span class="token punctuation">(</span>exclude <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">MongoAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">MongoDataAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//\u6392\u9664mongo\u7684\u81EA\u52A8\u914D\u7F6E</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>basePackages<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;com.tanhua&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">//\u8BBE\u7F6E\u626B\u63CF\u5305\u8303\u56F4</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServerApplication</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">ServerApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li></ul><h4 id="_6-2-2\u3001\u63A5\u53E3\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_6-2-2\u3001\u63A5\u53E3\u670D\u52A1" aria-hidden="true">#</a> 6.2.2\u3001\u63A5\u53E3\u670D\u52A1</h4><p>\u9700\u8981\u6CE8\u610F\u7684\u662F\uFF0C\u6587\u5B57\u662F\u5FC5\u987B\u63D0\u4EA4\u7684\uFF0C\u56FE\u7247\u662F\u975E\u5FC5\u987B\u7684\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//com.tanhua.server.controller.QuanZiController</span>
<span class="token doc-comment comment">/**
     * \u53D1\u9001\u52A8\u6001
     *
     * <span class="token keyword">@param</span> <span class="token parameter">textContent</span>
     * <span class="token keyword">@param</span> <span class="token parameter">location</span>
     * <span class="token keyword">@param</span> <span class="token parameter">multipartFile</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@PostMapping</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">savePublish</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;textContent&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> textContent<span class="token punctuation">,</span>
                                            <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;location&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token class-name">String</span> location<span class="token punctuation">,</span>
                                            <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;latitude&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token class-name">String</span> latitude<span class="token punctuation">,</span>
                                            <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;longitude&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token class-name">String</span> longitude<span class="token punctuation">,</span>
                                            <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;imageContent&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span><span class="token punctuation">[</span><span class="token punctuation">]</span> multipartFile<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> publishId <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quanZiService<span class="token punctuation">.</span><span class="token function">savePublish</span><span class="token punctuation">(</span>textContent<span class="token punctuation">,</span> location<span class="token punctuation">,</span> latitude<span class="token punctuation">,</span> longitude<span class="token punctuation">,</span> multipartFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>publishId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">INTERNAL_SERVER_ERROR</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-2-3\u3001quanziservice\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#_6-2-3\u3001quanziservice\u5B9E\u73B0" aria-hidden="true">#</a> 6.2.3\u3001QuanZiService\u5B9E\u73B0</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// com.tanhua.server.service.QuanZiService</span>

	<span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">PicUploadService</span> picUploadService<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">savePublish</span><span class="token punctuation">(</span><span class="token class-name">String</span> textContent<span class="token punctuation">,</span>
                               <span class="token class-name">String</span> location<span class="token punctuation">,</span>
                               <span class="token class-name">String</span> latitude<span class="token punctuation">,</span>
                               <span class="token class-name">String</span> longitude<span class="token punctuation">,</span>
                               <span class="token class-name">MultipartFile</span><span class="token punctuation">[</span><span class="token punctuation">]</span> multipartFile<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u67E5\u8BE2\u5F53\u524D\u7684\u767B\u5F55\u4FE1\u606F</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token class-name">UserThreadLocal</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Publish</span> publish <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Publish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        publish<span class="token punctuation">.</span><span class="token function">setUserId</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        publish<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>textContent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        publish<span class="token punctuation">.</span><span class="token function">setLocationName</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>
        publish<span class="token punctuation">.</span><span class="token function">setLatitude</span><span class="token punctuation">(</span>latitude<span class="token punctuation">)</span><span class="token punctuation">;</span>
        publish<span class="token punctuation">.</span><span class="token function">setLongitude</span><span class="token punctuation">(</span>longitude<span class="token punctuation">)</span><span class="token punctuation">;</span>
        publish<span class="token punctuation">.</span><span class="token function">setSeeType</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> picUrls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u56FE\u7247\u4E0A\u4F20</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file <span class="token operator">:</span> multipartFile<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">PicUploadResult</span> picUploadResult <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>picUploadService<span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
            picUrls<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>picUploadResult<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        publish<span class="token punctuation">.</span><span class="token function">setMedias</span><span class="token punctuation">(</span>picUrls<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quanZiApi<span class="token punctuation">.</span><span class="token function">savePublish</span><span class="token punctuation">(</span>publish<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7\u3001\u67E5\u8BE2\u63A8\u8350\u52A8\u6001" tabindex="-1"><a class="header-anchor" href="#_7\u3001\u67E5\u8BE2\u63A8\u8350\u52A8\u6001" aria-hidden="true">#</a> 7\u3001\u67E5\u8BE2\u63A8\u8350\u52A8\u6001</h2><p>\u63A8\u8350\u52A8\u6001\u662F\u901A\u8FC7\u63A8\u8350\u7CFB\u7EDF\u8BA1\u7B97\u51FA\u7684\u7ED3\u679C\uFF0C\u73B0\u5728\u6211\u4EEC\u53EA\u9700\u8981\u5B9E\u73B0\u67E5\u8BE2\u5373\u53EF\uFF0C\u63A8\u8350\u7CFB\u7EDF\u5728\u540E\u9762\u7684\u8BFE\u7A0B\u4E2D\u5B8C\u6210\u3002</p><p>\u63A8\u8350\u7CFB\u7EDF\u8BA1\u7B97\u5B8C\u6210\u540E\uFF0C\u4F1A\u5C06\u7ED3\u679C\u6570\u636E\u5199\u5165\u5230Redis\u4E2D\uFF0C\u6570\u636E\u5982\u4E0B\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">192.168</span>.31.81:637<span class="token operator"><span class="token file-descriptor important">9</span>&gt;</span> get QUANZI_PUBLISH_RECOMMEND_1
<span class="token string">&quot;2562,3639,2063,3448,2128,2597,2893,2333,3330,2642,2541,3002,3561,3649,2384,2504,3397,2843,2341,2249&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u770B\u5230\uFF0C\u5728Redis\u4E2D\u7684\u6570\u636E\u662F\u6709\u591A\u4E2A\u53D1\u5E03id\u7EC4\u6210\uFF08pid\uFF09\u7531\u9017\u53F7\u5206\u9694\u3002\u6240\u4EE5\u5B9E\u73B0\u4E2D\u9700\u8981\u81EA\u5DF1\u5BF9\u8FD9\u4E9B\u6570\u636E\u505A\u5206\u9875\u5904\u7406\u3002</p><h3 id="_7-1\u3001dubbo\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_7-1\u3001dubbo\u670D\u52A1" aria-hidden="true">#</a> 7.1\u3001dubbo\u670D\u52A1</h3><h4 id="_7-1-1\u3001\u5B9A\u4E49\u63A5\u53E3" tabindex="-1"><a class="header-anchor" href="#_7-1-1\u3001\u5B9A\u4E49\u63A5\u53E3" aria-hidden="true">#</a> 7.1.1\u3001\u5B9A\u4E49\u63A5\u53E3</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//com.tanhua.dubbo.server.api.QuanZiApi</span>

	<span class="token doc-comment comment">/**
     * \u67E5\u8BE2\u63A8\u8350\u52A8\u6001
     *
     * <span class="token keyword">@param</span> <span class="token parameter">userId</span> \u7528\u6237id
     * <span class="token keyword">@param</span> <span class="token parameter">page</span> \u5F53\u524D\u9875\u6570
     * <span class="token keyword">@param</span> <span class="token parameter">pageSize</span> \u6BCF\u4E00\u9875\u67E5\u8BE2\u7684\u6570\u636E\u6761\u6570
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Publish</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryRecommendPublishList</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token class-name">Integer</span> page<span class="token punctuation">,</span> <span class="token class-name">Integer</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7-1-2\u3001\u7F16\u5199\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#_7-1-2\u3001\u7F16\u5199\u5B9E\u73B0" aria-hidden="true">#</a> 7.1.2\u3001\u7F16\u5199\u5B9E\u73B0</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//com.tanhua.dubbo.server.api.QuanZiApiImpl</span>

	<span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> redisTemplate<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Publish</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryRecommendPublishList</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token class-name">Integer</span> page<span class="token punctuation">,</span> <span class="token class-name">Integer</span> pageSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Publish</span><span class="token punctuation">&gt;</span></span> pageInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageInfo<span class="token punctuation">.</span><span class="token function">setPageNum</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageInfo<span class="token punctuation">.</span><span class="token function">setPageSize</span><span class="token punctuation">(</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u67E5\u8BE2\u63A8\u8350\u7ED3\u679C\u6570\u636E</span>
        <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token string">&quot;QUANZI_PUBLISH_RECOMMEND_&quot;</span> <span class="token operator">+</span> userId<span class="token punctuation">;</span>
        <span class="token class-name">String</span> data <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> pageInfo<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//\u67E5\u8BE2\u5230\u7684pid\u8FDB\u884C\u5206\u9875\u5904\u7406</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> pids <span class="token operator">=</span> <span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token char">&#39;,&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u8BA1\u7B97\u5206\u9875</span>
        <span class="token comment">//[0, 10]</span>
        <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> startEnd <span class="token operator">=</span> <span class="token class-name">PageUtil</span><span class="token punctuation">.</span><span class="token function">transToStartEnd</span><span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> startIndex <span class="token operator">=</span> startEnd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//\u5F00\u59CB</span>
        <span class="token keyword">int</span> endIndex <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>startEnd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pids<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u7ED3\u675F</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> pidLongList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> startIndex<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> endIndex<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            pidLongList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>pids<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>pidLongList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//\u6CA1\u6709\u67E5\u8BE2\u5230\u6570\u636E</span>
            <span class="token keyword">return</span> pageInfo<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//\u6839\u636Epid\u67E5\u8BE2publish</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token class-name">Query</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;pid&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">in</span><span class="token punctuation">(</span>pidLongList<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span><span class="token class-name">Sort</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span><span class="token class-name">Sort<span class="token punctuation">.</span>Order</span><span class="token punctuation">.</span><span class="token function">desc</span><span class="token punctuation">(</span><span class="token string">&quot;created&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Publish</span><span class="token punctuation">&gt;</span></span> publishList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">Publish</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>publishList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//\u6CA1\u6709\u67E5\u8BE2\u5230\u6570\u636E</span>
            <span class="token keyword">return</span> pageInfo<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        pageInfo<span class="token punctuation">.</span><span class="token function">setRecords</span><span class="token punctuation">(</span>publishList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> pageInfo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-2\u3001app\u670D\u52A1" tabindex="-1"><a class="header-anchor" href="#_7-2\u3001app\u670D\u52A1" aria-hidden="true">#</a> 7.2\u3001APP\u670D\u52A1</h3><p>\u5730\u5740\uFF1Ahttps://mock-java.itheima.net/project/35/interface/api/677</p><p>\u901A\u8FC7\u63A5\u53E3\u7684\u5B9A\u4E49\u53EF\u4EE5\u770B\u51FA\uFF0C\u5176\u54CD\u5E94\u7684\u6570\u636E\u7ED3\u6784\u4E0E\u597D\u53CB\u52A8\u6001\u7ED3\u6784\u4E00\u6837\uFF0C\u6240\u4EE5\u53EF\u4EE5\u590D\u7528QuanZiVo\u5BF9\u8C61\u3002</p><h4 id="_7-2-1\u3001quanzicontroller" tabindex="-1"><a class="header-anchor" href="#_7-2-1\u3001quanzicontroller" aria-hidden="true">#</a> 7.2.1\u3001QuanZiController</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//com.tanhua.server.controller.QuanZiController</span>
	<span class="token doc-comment comment">/**
     * \u67E5\u8BE2\u63A8\u8350\u52A8\u6001
     *
     * <span class="token keyword">@param</span> <span class="token parameter">page</span>
     * <span class="token keyword">@param</span> <span class="token parameter">pageSize</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;recommend&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">PageResult</span> <span class="token function">queryRecommendPublishList</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;page&quot;</span><span class="token punctuation">,</span> defaultValue <span class="token operator">=</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> page<span class="token punctuation">,</span>
                                       <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;pagesize&quot;</span><span class="token punctuation">,</span> defaultValue <span class="token operator">=</span> <span class="token string">&quot;10&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> pageSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quanZiService<span class="token punctuation">.</span><span class="token function">queryRecommendPublishList</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7-2-2\u3001quanziservice" tabindex="-1"><a class="header-anchor" href="#_7-2-2\u3001quanziservice" aria-hidden="true">#</a> 7.2.2\u3001QuanZiService</h4><p>\u5728\u5B9E\u73B0\u4E2D\uFF0C\u5C06\u67E5\u8BE2\u597D\u53CB\u52A8\u6001\u7684\u65B9\u6CD5\u4E2D\u516C\u5171\u7684\u5185\u5BB9\uFF0C\u8FDB\u884C\u62BD\u53D6\uFF0C\u5177\u4F53\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//com.tanhua.server.service.QuanZiService</span>
    <span class="token keyword">public</span> <span class="token class-name">PageResult</span> <span class="token function">queryRecommendPublishList</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> page<span class="token punctuation">,</span> <span class="token class-name">Integer</span> pageSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u5206\u6790\uFF1A\u901A\u8FC7dubbo\u4E2D\u7684\u670D\u52A1\u67E5\u8BE2\u7CFB\u7EDF\u63A8\u8350\u52A8\u6001</span>
        <span class="token comment">//\u901A\u8FC7mysql\u67E5\u8BE2\u7528\u6237\u7684\u4FE1\u606F\uFF0C\u56DE\u5199\u5230\u7ED3\u679C\u5BF9\u8C61\u4E2D\uFF08QuanZiVo\uFF09</span>

        <span class="token class-name">PageResult</span> pageResult <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageResult<span class="token punctuation">.</span><span class="token function">setPage</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageResult<span class="token punctuation">.</span><span class="token function">setPagesize</span><span class="token punctuation">(</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//\u76F4\u63A5\u4ECEThreadLocal\u4E2D\u83B7\u53D6\u5BF9\u8C61</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token class-name">UserThreadLocal</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//\u901A\u8FC7dubbo\u67E5\u8BE2\u6570\u636E</span>
        <span class="token class-name">PageInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Publish</span><span class="token punctuation">&gt;</span></span> pageInfo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>quanZiApi<span class="token punctuation">.</span><span class="token function">queryRecommendPublishList</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> page<span class="token punctuation">,</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Publish</span><span class="token punctuation">&gt;</span></span> records <span class="token operator">=</span> pageInfo<span class="token punctuation">.</span><span class="token function">getRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>records<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> pageResult<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        pageResult<span class="token punctuation">.</span><span class="token function">setItems</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fillQuanZiVo</span><span class="token punctuation">(</span>records<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> pageResult<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>    <span class="token doc-comment comment">/**
     * \u586B\u5145\u7528\u6237\u4FE1\u606F
     *
     * <span class="token keyword">@param</span> <span class="token parameter">userInfo</span>
     * <span class="token keyword">@param</span> <span class="token parameter">quanZiVo</span>
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">fillUserInfoToQuanZiVo</span><span class="token punctuation">(</span><span class="token class-name">UserInfo</span> userInfo<span class="token punctuation">,</span> <span class="token class-name">QuanZiVo</span> quanZiVo<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">BeanUtil</span><span class="token punctuation">.</span><span class="token function">copyProperties</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">,</span> quanZiVo<span class="token punctuation">,</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        quanZiVo<span class="token punctuation">.</span><span class="token function">setGender</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">.</span><span class="token function">getSex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        quanZiVo<span class="token punctuation">.</span><span class="token function">setTags</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">.</span><span class="token function">getTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token char">&#39;,&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        quanZiVo<span class="token punctuation">.</span><span class="token function">setCommentCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//TODO \u8BC4\u8BBA\u6570</span>
        quanZiVo<span class="token punctuation">.</span><span class="token function">setDistance</span><span class="token punctuation">(</span><span class="token string">&quot;1.2\u516C\u91CC&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//TODO \u8DDD\u79BB</span>
        quanZiVo<span class="token punctuation">.</span><span class="token function">setHasLiked</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//TODO \u662F\u5426\u70B9\u8D5E\uFF081\u662F\uFF0C0\u5426\uFF09</span>
        quanZiVo<span class="token punctuation">.</span><span class="token function">setLikeCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//TODO \u70B9\u8D5E\u6570</span>
        quanZiVo<span class="token punctuation">.</span><span class="token function">setHasLoved</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//TODO \u662F\u5426\u559C\u6B22\uFF081\u662F\uFF0C0\u5426\uFF09</span>
        quanZiVo<span class="token punctuation">.</span><span class="token function">setLoveCount</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//TODO \u559C\u6B22\u6570</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u6839\u636E\u67E5\u8BE2\u5230\u7684publish\u96C6\u5408\u586B\u5145QuanZiVo\u5BF9\u8C61
     *
     * <span class="token keyword">@param</span> <span class="token parameter">records</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">QuanZiVo</span><span class="token punctuation">&gt;</span></span> <span class="token function">fillQuanZiVo</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Publish</span><span class="token punctuation">&gt;</span></span> records<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">QuanZiVo</span><span class="token punctuation">&gt;</span></span> quanZiVoList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        records<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>publish <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">QuanZiVo</span> quanZiVo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QuanZiVo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            quanZiVo<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>publish<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHexString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            quanZiVo<span class="token punctuation">.</span><span class="token function">setTextContent</span><span class="token punctuation">(</span>publish<span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            quanZiVo<span class="token punctuation">.</span><span class="token function">setImageContent</span><span class="token punctuation">(</span>publish<span class="token punctuation">.</span><span class="token function">getMedias</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            quanZiVo<span class="token punctuation">.</span><span class="token function">setUserId</span><span class="token punctuation">(</span>publish<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            quanZiVo<span class="token punctuation">.</span><span class="token function">setCreateDate</span><span class="token punctuation">(</span><span class="token class-name">RelativeDateFormat</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>publish<span class="token punctuation">.</span><span class="token function">getCreated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            quanZiVoList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>quanZiVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//\u67E5\u8BE2\u7528\u6237\u4FE1\u606F</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> userIds <span class="token operator">=</span> <span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">getFieldValues</span><span class="token punctuation">(</span>records<span class="token punctuation">,</span> <span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserInfo</span><span class="token punctuation">&gt;</span></span> userInfoList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userInfoService<span class="token punctuation">.</span><span class="token function">queryUserInfoByUserIdList</span><span class="token punctuation">(</span>userIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">QuanZiVo</span> quanZiVo <span class="token operator">:</span> quanZiVoList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//\u627E\u5230\u5BF9\u5E94\u7684\u7528\u6237\u4FE1\u606F</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">UserInfo</span> userInfo <span class="token operator">:</span> userInfoList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>quanZiVo<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">longValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> userInfo<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">longValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fillUserInfoToQuanZiVo</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">,</span> quanZiVo<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> quanZiVoList<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-3\u3001\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#_7-3\u3001\u6D4B\u8BD5" aria-hidden="true">#</a> 7.3\u3001\u6D4B\u8BD5</h3><p><img src="`+b+'" alt="image-20201211005052474"></p>',177),h=[y];function w(f,q){return a(),p("div",null,h)}const j=s(g,[["render",w],["__file","day04-\u5708\u5B50\u529F\u80FD\u5B9E\u73B0.html.vue"]]);export{j as default};
